<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.1.3,4 물질과 규칙성 - 원소의 주기성과 결합 (1-76번)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
        }
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .question-card {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .question-text {
            font-size: 1.1rem;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        .question-text .blank-emphasis { 
            font-weight: bold;
            color: #3b82f6; 
        }
        .option-label {
            display: block;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            background-color: #f7fafc;
        }
        .option-label:hover {
            background-color: #e2e8f0;
        }
        .option-input:checked + .option-label {
            background-color: #4299e1;
            color: white;
            border-color: #2b6cb0;
        }
        .feedback {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        .feedback.correct {
            background-color: #c6f6d5;
            color: #2f855a;
            border: 1px solid #9ae6b4;
        }
        .feedback.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border: 1px solid #fbb6ce;
        }
        .explanation {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #4a5568;
            line-height: 1.5;
        }
        .action-button {
            background-color: #4a5568;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            border: none;
            margin-top: 1rem;
            margin-right: 0.5rem;
        }
        .action-button:hover:not(:disabled) {
            background-color: #2d3748;
        }
        .action-button:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
        }
        .pagination-controls {
            display: flex; 
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .pagination-controls button, .pagination-controls span {
            margin: 0 0.25rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
        }
        .pagination-controls button:disabled {
            background-color: #e2e8f0;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .pagination-controls .page-number.current {
            background-color: #4299e1;
            color: white;
            border-color: #2b6cb0;
            font-weight: bold;
        }
        .score-section {
            margin-top: 1.5rem;
            padding: 1.5rem; 
            background-color: #e9f5ff;
            border-radius: 8px;
            text-align: left;
        }
        .score-text {
            font-size: 1.1rem;
            font-weight: 500;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }
        .quiz-title-in-score {
            font-size: 1.1rem; 
            font-weight: bold;
            color: #1e40af; 
            margin-bottom: 0.75rem; 
        }
        .motivational-quote { 
            font-size: 1rem;
            font-style: italic;
            color: #374151; 
            margin-top: 1.5rem; 
            padding-top: 1rem;
            border-top: 1px dashed #cbd5e0; 
            text-align: center;
        }
        h1 { 
            font-size: 1.8rem;
            font-weight: 700;
            color: #1a202c;
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .page-info {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #4a5568;
        }

        /* 팝업 스타일 */
        .popup-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); display: flex;
            justify-content: center; align-items: center; z-index: 1000; 
            opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .popup-overlay.show { opacity: 1; visibility: visible; }
        .popup-content {
            background-color: white; padding: 2.5rem; border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25); text-align: center;
            max-width: 420px; width: 90%;
        }
        .popup-content h2 {
            font-size: 1.75rem; font-weight: 700; color: #1a202c; margin-bottom: 1rem;
        }
        .popup-content p.welcome-message {
            font-size: 1rem; color: #4a5568; margin-bottom: 1.5rem; line-height: 1.6;
        }
        .popup-password-input {
            width: 100%; padding: 0.75rem; margin-bottom: 1rem;
            border: 1px solid #cbd5e0; border-radius: 6px; font-size: 1rem;
            box-sizing: border-box; 
        }
        .popup-confirm-btn {
            background-color: #3b82f6; color: white; padding: 0.75rem 1.5rem;
            border-radius: 8px; font-weight: 500; cursor: pointer;
            transition: background-color 0.2s; border: none; width: 100%;
            font-size: 1rem;
        }
        .popup-confirm-btn:hover { background-color: #2563eb; }
        .popup-error-message {
            color: #ef4444; font-size: 0.875rem; margin-top: 0.75rem;
            min-height: 1.25rem; 
        }
    </style>
</head>
<body>
    <div id="welcome-popup" class="popup-overlay">
        <div class="popup-content">
            <h2>Appia 과학학원</h2>
            <p class="welcome-message">유선종 선생님의 학습 자료입니다.<br>비밀번호를 입력해주세요.</p>
            <input type="password" id="popup-password" class="popup-password-input" placeholder="비밀번호">
            <button id="popup-confirm" class="popup-confirm-btn">확인</button>
            <p id="popup-error" class="popup-error-message"></p>
        </div>
    </div>
    <div class="quiz-container">
        <h1>2.1.3,4 물질과 규칙성 - 원소의 주기성과 결합 (60p ~ 74p)</h1>
        <div class="page-info" id="page-info"></div>
        <div id="quiz">
            </div>
        <div class="pagination-controls" id="pagination-controls">
            </div>
        <button id="submit-page-btn" class="action-button w-full sm:w-auto mx-auto block">이번 페이지 채점하기</button>
        <div class="score-section" id="score-section" style="display: none;">
            <p class="score-text quiz-title-in-score" id="quiz-main-title-in-score"></p> 
            <p class="score-text" id="current-page-score-text"></p>
            <p class="score-text" id="total-score-text"></p>
            <p class="motivational-quote" id="motivational-quote" style="display: none;"></p> 
        </div>
    </div>

    <script>
        // 문제 데이터 (PDF "2.1.3,4 물질과 규칙성-원소의 주기성과 결합.pdf" 기준)
        const questions = [
            {
                id: 1, type: 'ox', text: "1. 지금까지 알려진 원소는 100가지가 넘는다.",
                answer: "O", options: ["X", "O"],
                explanation: "현재까지 발견되거나 인공적으로 합성된 원소는 118종으로, 100가지가 넘습니다."
            },
            {
                id: 2, type: 'ox', text: "2. 자연에서 발견한 원소는 100가지가 넘는다.",
                answer: "X", options: ["O", "X"],
                explanation: "자연에서 발견된 원소는 약 90여 종이며 100가지가 넘지 않습니다. 나머지는 인공적으로 합성된 원소입니다."
            },
            {
                id: 3, type: 'fill-in', text: "3. 주기율표는 원소들을 (   ) 순서와 (   )을 기준으로 배열하였다.",
                answer: "원자번호;화학적 성질", options: ["원자량;물리적 성질", "원자번호;화학적 성질", "발견순서;색깔", "이름순서;밀도"],
                explanation: "현대의 주기율표는 원소들을 원자번호(양성자 수)가 증가하는 순서대로 배열하고, 화학적 성질이 비슷한 원소들이 같은 세로줄(족)에 오도록 배치한 것입니다."
            },
            {
                id: 4, type: 'fill-in', text: "4. 주기율표의 가로줄을 (   )라하며 1~ (   )까지 있다.",
                answer: "주기;7", options: ["족;18", "주기;7", "계열;4", "그룹;8"],
                explanation: "주기율표의 가로줄은 '주기'라고 하며, 현재까지 1주기부터 7주기까지의 원소들이 있습니다."
            },
            {
                id: 5, type: 'fill-in', text: "5. 주기율표의 세로줄을 (   )이라 하며 1~ (   )까지 있다.",
                answer: "족;18", options: ["주기;7", "계열;10", "족;18", "구역;4"],
                explanation: "주기율표의 세로줄은 '족'이라고 하며, 1족부터 18족까지 있습니다. 같은 족의 원소들은 원자가 전자 수가 같아 화학적 성질이 비슷합니다."
            },
            {
                id: 6, type: 'ox', text: "6. 1주기 원소의 개수는 2주기 원소의 개수와 같다.",
                answer: "X", options: ["O", "X"],
                explanation: "1주기 원소는 수소(H)와 헬륨(He) 2개이고, 2주기 원소는 리튬(Li)부터 네온(Ne)까지 8개입니다."
            },
            {
                id: 7, type: 'ox', text: "7. 2주기와 3주기 원소의 개수는 같다.",
                answer: "O", options: ["X", "O"],
                explanation: "2주기 원소(Li~Ne)와 3주기 원소(Na~Ar)는 각각 8개씩 있습니다."
            },
            {
                id: 8, type: 'ox', text: "8. 3주기 원소의 개수는 4주기 원소의 개수보다 작다.",
                answer: "O", options: ["O", "X"],
                explanation: "3주기 원소는 8개이고, 4주기 원소는 칼륨(K)부터 크립톤(Kr)까지 18개입니다."
            },
            {
                id: 9, type: 'fill-in', text: "9. H의 원자번호는 (   ), 양성자수는 (   )",
                answer: "1;1", options: ["1;0", "2;1", "1;1", "1;2"],
                explanation: "수소(H)의 원자번호는 1이며, 이는 양성자 수가 1개임을 의미합니다."
            },
            {
                id: 10, type: 'fill-in', text: "10. He의 원자번호는 (   ), 양성자수는 (   )",
                answer: "2;2", options: ["2;4", "2;2", "4;2", "1;2"],
                explanation: "헬륨(He)의 원자번호는 2이며, 이는 양성자 수가 2개임을 의미합니다."
            },
            {
                id: 11, type: 'fill-in', text: "11. [복자] H의 원자번호는 (1), 양성자수는 (1), 질량수는 (1), 중성자수는 (   )이다.",
                answer: "0", options: ["1", "2", "0", "알 수 없음"],
                explanation: "가장 흔한 수소 동위원소인 경수소(<sup>1</sup>H)는 원자번호 1, 양성자 수 1, 질량수 1이며, 중성자 수는 질량수 - 양성자 수 = 1 - 1 = 0개입니다."
            },
            {
                id: 12, type: 'fill-in', text: "12. [복자] He의 원자번호는 (2), 양성자수는 (2), 질량수는 (4), 중성자수는 (   )이다.",
                answer: "2", options: ["0", "1", "4", "2"],
                explanation: "가장 흔한 헬륨 동위원소인 헬륨-4(<sup>4</sup>He)는 원자번호 2, 양성자 수 2, 질량수 4이며, 중성자 수는 질량수 - 양성자 수 = 4 - 2 = 2개입니다."
            },
            {
                id: 13, type: 'ox', text: "13. 비금속 원소는 금속 원소보다 종류가 많다.",
                answer: "X", options: ["O", "X"],
                explanation: "주기율표에서 금속 원소는 약 90여 종으로, 비금속 원소(약 20여 종)보다 종류가 훨씬 많습니다."
            },
            {
                id: 14, type: 'ox', text: "14. 모든 14족 원소는 준금속 원소이다.",
                answer: "X", options: ["X", "O"],
                explanation: "14족 원소에는 비금속인 탄소(C), 준금속인 규소(Si)와 저마늄(Ge), 금속인 주석(Sn)과 납(Pb) 등이 포함됩니다."
            },
            {
                id: 15, type: 'fill-in', text: "15. 연필심을 구성하는 (   )은 비금속 원소인 (   )로 이루어져 있지만 전기가 통한다.",
                answer: "흑연;탄소", options: ["다이아몬드;탄소", "구리;구리", "흑연;탄소", "철;철"],
                explanation: "연필심의 주성분인 흑연은 탄소(C)로 이루어진 비금속 동소체이지만, 특유의 층상 구조로 인해 자유롭게 이동할 수 있는 전자가 있어 전기가 통합니다."
            },
            {
                id: 16, type: 'fill-in', text: "16. 외부에서 힘을 가하면 부서지지 않고 모양만 변하는 것은 (   ) 원소의 특징이다.",
                answer: "금속", options: ["비금속", "금속", "준금속", "할로젠"],
                explanation: "금속 원소는 연성(뽑힘성)과 전성(펴짐성)이 있어 외부에서 힘을 가하면 부서지기보다는 모양이 변하는 특징이 있습니다."
            },
            {
                id: 17, type: 'ox', text: "17. 모든 비금속 원소는 상온에서 기체상태이다.",
                answer: "X", options: ["O", "X"],
                explanation: "비금속 원소 중에는 상온에서 기체(예: 수소, 산소, 질소, 염소), 액체(예: 브로민), 고체(예: 탄소, 인, 황, 아이오딘) 상태인 것들이 모두 존재합니다."
            },
            {
                id: 18, type: 'fill-in', text: "18. 성냥에 이용되는 원소는 (   )으로 (   ) 원소이다.",
                answer: "인;비금속", options: ["황;비금속", "칼륨;금속", "염소;비금속", "인;비금속"],
                explanation: "성냥 머리에는 마찰에 의해 쉽게 불이 붙는 적린(붉은 인)이 사용되며, 인(P)은 비금속 원소입니다."
            },
            {
                id: 19, type: 'ox', text: "19. 연필심과 다이아몬드를 이루는 원소는 같다.",
                answer: "O", options: ["X", "O"],
                explanation: "연필심의 주성분인 흑연과 다이아몬드는 모두 탄소(C)라는 동일한 원소로 이루어져 있지만, 원자 배열 구조가 달라 물리적 성질이 매우 다른 동소체입니다."
            },
            {
                id: 20, type: 'ox', text: "20. 주기율표의 모든 1족 원소는 알칼리 금속이다.",
                answer: "X", options: ["O", "X"],
                explanation: "1족 원소 중 수소(H)는 비금속 원소이며 알칼리 금속에 포함되지 않습니다. 리튬(Li)부터 프랑슘(Fr)까지가 알칼리 금속입니다."
            },
            {
                id: 21, type: 'ox', text: "21. 수소의 원자가 전자는 1개이다.",
                answer: "O", options: ["O", "X"],
                explanation: "수소(H)는 전자가 1개이며, 이 전자가 가장 바깥 전자껍질에 있는 원자가 전자입니다."
            },
            {
                id: 22, type: 'fill-in', text: "22. 알칼리 금속은 (   )가 작아 물에 뜬다.",
                answer: "밀도", options: ["녹는점", "반응성", "밀도", "경도"],
                explanation: "리튬, 나트륨, 칼륨과 같은 알칼리 금속은 다른 금속에 비해 밀도가 매우 작아 물보다 밀도가 작은 경우 물에 뜹니다 (예: 리튬, 나트륨)."
            },
            {
                id: 23, type: 'ox', text: "23. 알칼리 금속은 공기 중에 보관한다.",
                answer: "X", options: ["X", "O"],
                explanation: "알칼리 금속은 반응성이 매우 커서 공기 중의 산소나 수분과 빠르게 반응하므로 공기 중에 그대로 보관하지 않습니다."
            },
            {
                id: 24, type: 'ox', text: "24. 알칼리 금속은 물 속에 보관한다.",
                answer: "X", options: ["O", "X"],
                explanation: "알칼리 금속은 물과 격렬하게 반응하여 수소 기체를 발생시키고 폭발할 수 있으므로 절대 물 속에 보관하지 않습니다."
            },
            {
                id: 25, type: 'fill-in', text: "25. 알칼리 금속은 반응성이 커 공기 중의 (   )와 반응한다.",
                answer: "산소", options: ["질소", "아르곤", "산소", "이산화탄소"],
                explanation: "알칼리 금속은 공기 중에 노출되면 표면이 산소와 반응하여 빠르게 산화물을 형성하며 광택을 잃습니다."
            },
            {
                id: 26, type: 'fill-in', text: "26. 알칼리 금속은 (   ) (   )에 담가 보관한다.",
                answer: "석유;파라핀", options: ["물;알코올", "석유;파라핀", "염산;질산", "공기;진공"],
                explanation: "알칼리 금속은 공기 중의 산소 및 수분과의 반응을 막기 위해 등유, 경유와 같은 석유 제품이나 파라핀 액체 속에 담가 보관합니다."
            },
            {
                id: 27, type: 'fill-in', text: "27. 알칼리 금속의 밀도는 (   )이 제일 작다.",
                answer: "리튬", options: ["나트륨", "칼륨", "루비듐", "리튬"],
                explanation: "알칼리 금속 중에서 리튬(Li)의 밀도가 약 0.53 g/cm<sup>3</sup>로 가장 작습니다."
            },
            {
                id: 28, type: 'fill-in', text: "28. 할로젠 원소는 실온에서 원자 2개가 결합한 (   )형태로 존재한다.",
                answer: "분자", options: ["이온", "분자", "원자", "화합물"],
                explanation: "할로젠 원소(플루오린 F, 염소 Cl, 브로민 Br, 아이오딘 I)는 반응성이 커서 실온에서 두 개의 원자가 공유 결합하여 이원자 분자(F<sub>2</sub>, Cl<sub>2</sub>, Br<sub>2</sub>, I<sub>2</sub>) 형태로 안정하게 존재합니다."
            },
            {
                id: 29, type: 'fill-in', text: "29. F는 (   )이라 읽으며, (   )주기 (   )족 이다.",
                answer: "플루오린;2;17", options: ["염소;3;17", "브로민;2;1", "플루오린;2;17", "아이오딘;5;18"],
                explanation: "F는 원소기호로 플루오린(Fluorine)을 나타내며, 주기율표에서 2주기 17족에 속하는 할로젠 원소입니다."
            },
            {
                id: 30, type: 'fill-in', text: "30. (Cl)은 (   )라 읽으며, (   )주기 (   )족이다.", // PDF에 '예은'으로 오타
                answer: "염소;3;17", options: ["플루오린;2;17", "염소;3;17", "브로민;4;1", "황;3;16"],
                explanation: "Cl은 원소기호로 염소(Chlorine)를 나타내며, 주기율표에서 3주기 17족에 속하는 할로젠 원소입니다."
            },
            {
                id: 31, type: 'fill-in', text: "31. Br은 (   )이라 읽으며, (   )주기 (   )족 이다.",
                answer: "브로민;4;17", options: ["아이오딘;5;17", "염소;3;1", "브로민;4;17", "아스타틴;6;17"],
                explanation: "Br은 원소기호로 브로민(Bromine)을 나타내며, 주기율표에서 4주기 17족에 속하는 할로젠 원소입니다."
            },
            {
                id: 32, type: 'fill-in', text: "32. (I)는 (   )이라 읽으며, (   )주기 (   )족 이다.", // PDF에 기호 누락
                answer: "아이오딘;5;17", options: ["브로민;4;17", "플루오린;2;1", "아이오딘;5;17", "텔루륨;5;16"],
                explanation: "I는 원소기호로 아이오딘(Iodine)을 나타내며, 주기율표에서 5주기 17족에 속하는 할로젠 원소입니다."
            },
            {
                id: 33, type: 'fill-in', text: "33. 할로젠 원소 중 기체 상태에서 보라색을 띠는 것은 (I<sub>2</sub>)이다.",
                answer: "I₂", options: ["Br₂", "Cl₂", "F₂", "I₂"],
                explanation: "아이오딘(I<sub>2</sub>)은 상온에서 고체이지만 승화성이 강해 쉽게 기체가 되며, 아이오딘 기체는 보라색을 띱니다."
            },
            {
                id: 34, type: 'fill-in', text: "34. 할로젠 원소 중 기체 상태에서 적갈색을 띠는 것은 (Br<sub>2</sub>)이다.",
                answer: "Br₂", options: ["Cl₂", "F₂", "Br₂", "I₂"],
                explanation: "브로민(Br<sub>2</sub>)은 상온에서 적갈색의 액체이며, 쉽게 증발하여 적갈색의 기체가 됩니다."
            },
            {
                id: 35, type: 'fill-in', text: "35. 할로젠 원소 중 기체 상태에서 노란색을 띠는 것은 (Cl<sub>2</sub>)이다.",
                answer: "Cl₂", options: ["F₂", "Br₂", "I₂", "Cl₂"],
                explanation: "염소(Cl<sub>2</sub>)는 상온에서 황록색(또는 옅은 노란색)을 띠는 기체입니다."
            },
            {
                id: 36, type: 'fill-in', text: "36. 알칼리 금속을 물에 넣으면 수용액은 (   )성을 띠며, (   )용액을 수용액에 넣으면 (   )게 변한다.",
                answer: "염기;페놀프탈레인;붉", options: ["산;BTB;노랗", "중성;리트머스;변화없", "염기;메틸오렌지;노랗", "염기;페놀프탈레인;붉"],
                explanation: "알칼리 금속은 물과 반응하여 수산화물(예: NaOH, KOH)을 생성하고 수소 기체를 발생시킵니다. 이 수산화물은 물에 녹아 강한 염기성을 나타내므로, 페놀프탈레인 용액을 넣으면 붉은색으로 변합니다."
            },
            {
                id: 37, type: 'fill-in', text: "37. 전자가 특정한 (   )를 가지는 궤도를 (   )이라 한다.",
                answer: "에너지 준위;전자껍질", options: ["운동량;오비탈", "에너지 준위;전자껍질", "스핀;원자핵", "전하량;양성자"],
                explanation: "보어의 원자 모형에서 전자는 원자핵 주위의 불연속적인 특정 에너지 값을 갖는 궤도, 즉 전자껍질(에너지 준위)에서만 운동한다고 설명합니다."
            },
            {
                id: 38, type: 'fill-in', text: "38. (   )의 원자 모형에서 원자핵과 가까울수록 전자의 에너지 준위는 (   )다.",
                answer: "보어;낮", options: ["톰슨;높", "러더퍼드;같", "보어;낮", "돌턴;변함없"],
                explanation: "닐스 보어의 원자 모형에 따르면, 전자는 원자핵에서 가까운 전자껍질일수록 낮은 에너지 준위를 가지며, 핵에서 멀어질수록 에너지 준위가 높아집니다."
            },
            {
                id: 39, type: 'ox', text: "39. 모든 원자는 두 번째 껍질에 전자가 8개까지 채워진 후 다음 전자 껍질에 전자가 채워진다.",
                answer: "X", options: ["O", "X"],
                explanation: "일반적으로 원자번호 20번까지의 원소들은 두 번째 전자껍질에 전자가 8개까지 채워지면 안정한 옥텟 규칙을 만족하며, 세 번째 껍질에도 8개가 채워진 후 네 번째 껍질로 전자가 채워지는 경향을 보입니다. 하지만 모든 원자가 엄격히 이 규칙을 따르는 것은 아니며, 특히 전이금속 등에서는 더 복잡한 전자 배치를 가집니다."
            },
            {
                id: 40, type: 'ox', text: "40. 1~18번에 해당하는 원자는 두 번째와 세 번째 껍질에 전자가 최대 8개까지 채워진다.",
                answer: "O", options: ["X", "O"],
                explanation: "원자번호 1번부터 18번까지의 원소들(1주기~3주기)은 K껍질(첫 번째)에 최대 2개, L껍질(두 번째)에 최대 8개, M껍질(세 번째)에 최대 8개(3주기 원소의 경우 최외각으로 작용 시)까지 전자가 채워지는 경향을 따릅니다."
            },
            {
                id: 41, type: 'fill-in', text: "41. (   )란 가장 바깥쪽의 전자 껍질에 채워져 있으며, 원소의 (   )과 관련되어 있는 전자이다.",
                answer: "원자가전자;화학적 성질", options: ["핵전자;물리적 성질", "자유전자;전기 전도성", "원자가전자;화학적 성질", "공유전자;결합력"],
                explanation: "원자가 전자는 원자의 가장 바깥쪽 전자껍질에 있는 전자들로, 화학 결합에 직접 참여하여 원소의 화학적 성질을 결정하는 데 중요한 역할을 합니다."
            },
            {
                id: 42, type: 'fill-in', text: "42. 새롭게 발견된 원소의 성질이 알칼리 금속과 비슷하다면 그 원소의 원자가 전자 수는 아마도 (   )개일 것이다.",
                answer: "1", options: ["2", "7", "8", "1"],
                explanation: "알칼리 금속(1족, 수소 제외)은 원자가 전자를 1개 가지고 있어 화학적 성질이 비슷합니다. 따라서 새로운 원소가 알칼리 금속과 성질이 유사하다면 원자가 전자 수가 1개일 가능성이 큽니다."
            },
            {
                id: 43, type: 'fill-in', text: "43. 같은 주기에 속하는 원소는 (   )수가 같다.",
                answer: "전자껍질", options: ["원자가전자", "양성자", "전자껍질", "중성자"],
                explanation: "주기율표에서 같은 주기(가로줄)에 속하는 원소들은 전자가 채워져 있는 전자껍질의 수가 같습니다."
            },
            {
                id: 44, type: 'fill-in', text: "44. 같은 족 원소는 유사한 (   ) 성질을 갖는다.",
                answer: "화학적", options: ["물리적", "화학적", "핵적", "기계적"],
                explanation: "같은 족(세로줄)에 속하는 원소들은 원자가 전자 수가 같기 때문에 화학적 성질이 매우 유사합니다."
            },
            {
                id: 45, type: 'ox', text: "45. 모든 원소는 같은 족이면 원자가 전자수가 같다.",
                answer: "O", options: ["O", "X"],
                explanation: "일반적으로 같은 족의 원소들은 원자가 전자 수가 같습니다. (예: 1족은 1개, 17족은 7개). 단, 18족의 헬륨은 2개, 나머지는 8개(또는 0개)로 예외적인 경우가 있지만, 문제의 일반적 의도는 '같다'입니다."
            },
            {
                id: 46, type: 'ox', text: "46. 모든 원소는 같은 족이면 가장 바깥 전자껍질에 전자 수가 같다.",
                answer: "X", options: ["X", "O"],
                explanation: "18족 원소인 헬륨(He)은 가장 바깥 전자껍질(K껍질)에 전자가 2개 있지만, 같은 18족인 네온(Ne)은 가장 바깥 전자껍질(L껍질)에 전자가 8개 있습니다. 따라서 '모든 원소'에 대해 이 진술은 틀립니다."
            },
            {
                id: 47, type: 'fill-in', text: "47. (   )란 (   )족 원소를 뜻하며, 원자가 전자수가 (   )개이다.",
                answer: "비활성 기체;18;0", options: ["할로젠;17;7", "알칼리 금속;1;1", "비활성 기체;18;0", "전이 금속;3-12;다양"],
                explanation: "비활성 기체는 주기율표의 18족 원소들(헬륨, 네온, 아르곤 등)을 말합니다. 이들은 가장 바깥 전자껍질이 전자로 가득 차 있어 매우 안정하며 화학적으로 거의 반응하지 않습니다. 헬륨은 원자가 전자가 2개, 나머지는 8개(또는 화학적 의미에서 0개)로 표현합니다."
            },
            {
                id: 48, type: 'fill-in', text: "48. 안정한 전자 배치란 첫 번째 껍질에 전자를 (   )개, 두 번째, 세 번째 껍질에 전자를 (   )개까지 가득 채운 상태를 말한다.",
                answer: "2;8", options: ["1;8", "2;8", "8;8", "2;18"],
                explanation: "옥텟 규칙에 따르면, 원자들은 가장 바깥 전자껍질에 전자를 8개(첫 번째 껍질은 2개) 채워 비활성 기체와 같은 안정한 전자 배치를 이루려는 경향이 있습니다."
            },
            {
                id: 49, type: 'fill-in', text: "49. (   )은 광고용 기구를 띄울 때 이용한다.",
                answer: "헬륨", options: ["네온", "아르곤", "헬륨", "수소"],
                explanation: "헬륨(He)은 공기보다 가볍고 불에 타지 않는 비활성 기체이므로 광고용 풍선이나 비행선 등을 띄우는 데 안전하게 사용됩니다."
            },
            {
                id: 50, type: 'fill-in', text: "50. (   )은 빛을 내는 간판에 이용한다.",
                answer: "네온", options: ["헬륨", "네온", "아르곤", "크립톤"],
                explanation: "네온(Ne)은 방전 시 밝은 붉은색 빛을 내므로 네온사인과 같은 광고용 간판이나 조명에 널리 사용됩니다."
            },
            {
                id: 51, type: 'fill-in', text: "51. (   )은 이중창의 유리 사이를 채울 때 이용한다.",
                answer: "아르곤", options: ["헬륨", "네온", "질소", "아르곤"],
                explanation: "아르곤(Ar)은 공기보다 열전도율이 낮고 반응성이 없는 비활성 기체이므로, 이중창 유리 사이에 주입하여 단열 효과를 높이는 데 사용됩니다."
            },
            {
                id: 52, type: 'fill-in', text: "52. 지구와 생명체를 구성하는 산소, 규소, 탄소, 수소 등의 원소는 (   )족 원소와 같은 전자배치를 이루기 위해 (   )를 잃거나 얻기도 하고 (   )하기도 한다.",
                answer: "18;전자;공유", options: ["1;양성자;이온화", "17;중성자;결합", "18;전자;공유", "2;쿼크;반응"],
                explanation: "대부분의 원소들은 가장 안정한 18족 비활성 기체와 같은 전자 배치를 이루기 위해 다른 원자와 전자를 주고받아 이온이 되거나(이온 결합), 전자를 함께 나누어 가짐으로써(공유 결합) 화학 결합을 형성합니다."
            },
            {
                id: 53, type: 'fill-in', text: "53. 금속 원소는 전자를 (   )어 (   )이온이 되기 쉽다.",
                answer: "잃;양", options: ["얻;음", "잃;양", "공유하;중성", "방출하;음"],
                explanation: "금속 원소들은 대체로 원자가 전자의 수가 적어, 이 전자들을 잃어버리고 양(+)전하를 띤 양이온이 되어 안정한 전자 배치를 이루려는 경향이 강합니다."
            },
            {
                id: 54, type: 'fill-in', text: "54. 비금속 원소는 (   )를 (   )어 (   )이온이 되기 쉽다.",
                answer: "전자;얻;음", options: ["양성자;잃;양", "중성자;공유하;중성", "전자;얻;음", "전자;흡수하;양"],
                explanation: "비금속 원소들은 대체로 원자가 전자의 수가 많아, 전자를 더 얻어서 음(-)전하를 띤 음이온이 되어 안정한 전자 배치를 이루려는 경향이 강합니다."
            },
            {
                id: 55, type: 'fill-in', text: "55. 금속 원소가 안정한 전자 배치를 이루면 (원래 주기 - 1)주기, (   )족 원소와 같아진다.",
                answer: "18", options: ["1", "2", "17", "18"],
                explanation: "금속 원소가 전자를 잃고 양이온이 되면, 그 전자 배치는 보통 자신보다 원자번호가 작은, 즉 이전 주기의 18족 비활성 기체와 같은 전자 배치를 갖게 됩니다. (예: Na (2,8,1) → Na<sup>+</sup> (2,8)은 Ne과 같음)"
            },
            {
                id: 56, type: 'fill-in', text: "56. 비금속 원소가 안정한 전자 배치를 이루면 (   )주기, (   )족 원소와 같아진다.",
                answer: "원래;18", options: ["이전;1", "다음;17", "원래;18", "두 단계 다음;2"],
                explanation: "비금속 원소가 전자를 얻어 음이온이 되면, 그 전자 배치는 보통 자신과 같은 주기의 18족 비활성 기체와 같은 전자 배치를 갖게 됩니다. (예: Cl (2,8,7) → Cl<sup>-</sup> (2,8,8)은 Ar과 같음)"
            },
            {
                id: 57, type: 'fill-in', text: "57. 이온 결합이란 (   )과 (   )사이에 (   )에 의해 형성",
                answer: "양이온;음이온;정전기적 인력", options: ["원자;원자;공유", "양이온;음이온;정전기적 인력", "분자;분자;반데르발스 힘", "양이온;전자;금속 결합"],
                explanation: "이온 결합은 금속 원자가 전자를 잃어 생성된 양이온과 비금속 원자가 전자를 얻어 생성된 음이온 사이에 작용하는 강한 정전기적 인력에 의해 형성되는 화학 결합입니다."
            },
            {
                id: 58, type: 'fill-in', text: "58. 이온 결합 물질 자체는 전기적으로 (   )이며 규칙적인 (   )구조를 이룬다.",
                answer: "중성;입체", options: ["양성;선형", "음성;평면", "중성;입체", "전도성;비정질"],
                explanation: "이온 결합 물질은 양이온과 음이온이 결합하여 전체적으로는 전기적 중성을 띠며, 이온들이 규칙적으로 배열된 결정 구조(입체 구조)를 이룹니다."
            },
            {
                id: 59, type: 'fill-in', text: "59. 우리 몸에 가장 많은 물질은 (   )결합 물질이다.",
                answer: "공유", options: ["이온", "금속", "수소", "공유"],
                explanation: "우리 몸의 약 70%를 차지하는 물(H<sub>2</sub>O)은 수소와 산소가 전자를 공유하여 이루어진 공유 결합 물질입니다. 또한 단백질, 탄수화물, 지방, 핵산 등 생명체를 구성하는 주요 유기물들도 대부분 공유 결합을 통해 형성됩니다."
            },
            {
                id: 60, type: 'fill-in', text: "60. 물(H<sub>2</sub>O)의 공유 전자쌍은 (   )쌍이고, 공유 전자수는 (   )개, (   ) 결합 2번",
                answer: "2;4;단일", options: ["1;2;이중", "2;4;단일", "3;6;삼중", "4;8;배위"],
                explanation: "물 분자(H<sub>2</sub>O)에서 산소 원자 1개는 각각의 수소 원자 2개와 단일 공유 결합을 1개씩 형성합니다. 따라서 공유 전자쌍은 총 2쌍이고, 공유하는 전자의 총 수는 4개입니다."
            },
            {
                id: 61, type: 'fill-in', text: "61. 산소(O<sub>2</sub>)의 공유 전자쌍은 (   )쌍이고, 공유 전자수는 (   )개, (   )결합 1번", // PDF에 O₂ 기호 누락
                answer: "2;4;이중", options: ["1;2;단일", "3;6;삼중", "2;4;이중", "4;8;단일"],
                explanation: "산소 분자(O<sub>2</sub>)에서 두 산소 원자는 각각 2개의 전자를 내놓아 총 2쌍의 공유 전자쌍을 형성하는 이중 결합을 이룹니다. 따라서 공유 전자쌍은 2쌍, 공유 전자수는 4개입니다."
            },
            {
                id: 62, type: 'fill-in', text: "62. 물(H<sub>2</sub>O)의 수소 원자는 (   )과 같은 안정한 배치를, 산소 원자는 (   )과 같은 안정한 배치를 이룬다.",
                answer: "헬륨;네온", options: ["네온;아르곤", "수소;산소", "헬륨;네온", "리튬;플루오린"],
                explanation: "물 분자에서 수소 원자는 전자 1개를 공유 받아 총 2개의 전자를 가져 헬륨(He)과 같은 안정한 전자 배치를 이루고, 산소 원자는 2개의 전자를 공유 받아 총 8개의 원자가 전자를 가져 네온(Ne)과 같은 안정한 전자 배치를 이룹니다."
            },
            {
                id: 63, type: 'fill-in', text: "63. 플루오린화 수소(HF)의 공유 전자쌍은 (   )쌍이고, 공유 전자수는 (   )개",
                answer: "1;2", options: ["1;1", "2;2", "1;2", "2;4"], // PDF는 공유 전자수 1개로 되어있으나, 공유 전자쌍이 1쌍이므로 공유 전자는 2개가 맞음.
                explanation: "플루오린화 수소(HF) 분자에서 수소 원자와 플루오린 원자는 각각 1개의 전자를 내놓아 1쌍의 공유 전자쌍을 형성하는 단일 결합을 이룹니다. 따라서 공유 전자쌍은 1쌍, 공유 전자수는 2개입니다."
            },
            {
                id: 64, type: 'ox', text: "64. 플루오린화 수소(HF)의 수소 원자와 플루오린 원자의 안정한 배치는 같다.",
                answer: "X", options: ["O", "X"], // PDF는 O로 되어있으나, H는 He, F는 Ne과 같은 배치이므로 다름.
                explanation: "HF에서 수소 원자는 전자 2개를 가져 헬륨(He)과 같은 전자 배치를, 플루오린 원자는 원자가 전자 8개를 가져 네온(Ne)과 같은 전자 배치를 이룹니다. 따라서 두 원자가 도달하는 안정한 비활성 기체의 종류가 다릅니다."
            },
            {
                id: 65, type: 'fill-in', text: "65. 달걀 껍데기의 주성분인 (   )은 (   )결합 물질이다.",
                answer: "탄산칼슘;이온", options: ["염화나트륨;공유", "탄산칼슘;이온", "수산화칼슘;금속", "황산칼슘;분자"],
                explanation: "달걀 껍데기의 주성분은 탄산칼슘(CaCO<sub>3</sub>)으로, 칼슘 이온(Ca<sup>2+</sup>)과 탄산 이온(CO<sub>3</sub><sup>2-</sup>) 사이의 이온 결합으로 이루어진 물질입니다."
            },
            {
                id: 66, type: 'fill-in', text: "66. 제산제의 주성분인 (   )은 (   )결합 물질이다.",
                answer: "수산화마그네슘;이온", options: ["탄산수소나트륨;공유", "염산;산성", "수산화마그네슘;이온", "아스피린;분자"],
                explanation: "많은 제산제의 주성분으로 사용되는 수산화마그네슘(Mg(OH)<sub>2</sub>)은 마그네슘 이온(Mg<sup>2+</sup>)과 수산화 이온(OH<sup>-</sup>) 2개 사이의 이온 결합으로 이루어진 물질입니다."
            },
            {
                id: 67, type: 'fill-in', text: "67. 설탕은 (   )결합 물질이다.",
                answer: "공유", options: ["이온", "금속", "공유", "단당류"],
                explanation: "설탕(자당, C<sub>12</sub>H<sub>22</sub>O<sub>11</sub>)은 탄소, 수소, 산소 원자들이 공유 결합을 통해 이루어진 유기 화합물(분자)입니다."
            },
            {
                id: 68, type: 'fill-in', text: "68. 휴대용 가스 레인지의 연료인 (   )은 (   )결합 물질이다.",
                answer: "뷰테인;공유", options: ["프로페인;이온", "뷰테인;공유", "메테인;금속", "에탄올;분자"],
                explanation: "휴대용 가스레인지 연료로 주로 사용되는 뷰테인(부탄, C<sub>4</sub>H<sub>10</sub>)은 탄소와 수소 원자들이 공유 결합을 통해 이루어진 탄화수소입니다."
            },
            {
                id: 69, type: 'fill-in', text: "69. 탄산칼슘의 화학식은 (   )",
                answer: "CaCO₃", options: ["CaCl₂", "CaO", "CaSO₄", "CaCO₃"],
                explanation: "탄산칼슘은 칼슘(Ca)과 탄산 이온(CO<sub>3</sub>)이 1:1로 결합한 화합물로 화학식은 CaCO<sub>3</sub>입니다."
            },
            {
                id: 70, type: 'fill-in', text: "70. 뷰테인의 화학식은 (   )",
                answer: "C₄H₁₀", options: ["CH₄", "C₂H₆", "C₄H₁₀", "C₃H₈"],
                explanation: "뷰테인(부탄)은 탄소 원자 4개와 수소 원자 10개가 공유 결합한 탄화수소로, 화학식은 C<sub>4</sub>H<sub>10</sub>입니다."
            },
            {
                id: 71, type: 'fill-in', text: "71. 수산화 마그네슘의 화학식은 (   )",
                answer: "Mg(OH)₂", options: ["Mg(OH)₂", "MgO", "MgCl₂", "MgSO₄"],
                explanation: "수산화마그네슘은 마그네슘 이온(Mg<sup>2+</sup>) 1개와 수산화 이온(OH<sup>-</sup>) 2개가 결합한 이온 결합 화합물로, 화학식은 Mg(OH)<sub>2</sub>입니다."
            },
            {
                id: 72, type: 'ox', text: "72. 고체 상태의 이온 결합 물질은 전기전도성이 있다.",
                answer: "X", options: ["O", "X"],
                explanation: "고체 상태의 이온 결합 물질은 이온들이 강하게 결합하여 자유롭게 이동할 수 없으므로 전류가 흐르지 않습니다. 액체 상태로 녹이거나 물에 녹여 수용액으로 만들면 이온들이 이동할 수 있게 되어 전기 전도성을 가집니다."
            },
            {
                id: 73, type: 'ox', text: "73. 증류수는 전기전도성이 있다.",
                answer: "X", options: ["X", "O"],
                explanation: "순수한 물인 증류수에는 이온이 거의 존재하지 않으므로 전류가 매우 약하게 흐르거나 거의 흐르지 않습니다."
            },
            {
                id: 74, type: 'ox', text: "74. 순수한 물인 증류수에는 이온이 들어 있다.",
                answer: "X", options: ["O", "X"],
                explanation: "순수한 물도 극히 일부는 H<sup>+</sup>와 OH<sup>-</sup>로 자동 이온화되지만, 그 농도가 매우 낮아 전기 전도성은 거의 무시할 수 있을 정도입니다. 일반적으로 이온이 거의 없다고 간주합니다."
            },
            {
                id: 75, type: 'ox', text: "75. 모든 공유 결합 물질은 수용액 상태에서 전기전도성이 없다.",
                answer: "X", options: ["X", "O"],
                explanation: "대부분의 공유 결합 물질(예: 설탕, 에탄올)은 물에 녹아도 이온화되지 않아 전기 전도성이 없지만, 염화수소(HCl), 아세트산(CH<sub>3</sub>COOH)과 같은 일부 공유 결합 물질은 물에 녹아 이온화하여 전기 전도성을 나타냅니다 (이들을 전해질이라고 함)."
            },
            {
                id: 76, type: 'ox', text: "76. 이온 결합 물질은 수용액 상태에서 전기 전도성이 있다.",
                answer: "O", options: ["X", "O"],
                explanation: "이온 결합 물질은 물에 녹으면 양이온과 음이온으로 나뉘어 자유롭게 이동할 수 있게 되므로 수용액 상태에서 전기 전도성을 나타냅니다."
            }
        ];

        // 명언 목록
        const motivationalQuotes = [
            "오늘의 노력이 내일의 너를 만든다.", "포기하지 않는 한, 실패는 없다.", "가장 큰 위험은 아무 위험도 감수하지 않는 것이다.",
            "배움은 의무도, 생존도 아니다. 그것은 우리의 가장 큰 특권이다.", "성공은 최종 목적지가 아니며, 실패는 치명적이지 않다. 중요한 것은 계속 나아가는 용기다.",
            "작은 성공들이 모여 큰 성공을 이룬다.", "어제보다 나은 오늘, 오늘보다 나은 내일을 만들자.",
            "가장 큰 영광은 한 번도 실패하지 않음이 아니라 실패할 때마다 다시 일어서는 데에 있다.", "천리길도 한 걸음부터.", "노력은 결코 배신하지 않는다."
        ];

        const quizElement = document.getElementById('quiz');
        const paginationControlsElement = document.getElementById('pagination-controls');
        const submitPageButton = document.getElementById('submit-page-btn');
        const scoreSectionElement = document.getElementById('score-section');
        const currentPageScoreTextElement = document.getElementById('current-page-score-text');
        const totalScoreTextElement = document.getElementById('total-score-text');
        const pageInfoElement = document.getElementById('page-info');
        const quizMainTitleDisplayElement = document.getElementById('quiz-main-title-in-score');
        const motivationalQuoteElement = document.getElementById('motivational-quote'); 
        
        const welcomePopup = document.getElementById('welcome-popup');
        const popupPasswordInput = document.getElementById('popup-password');
        const popupConfirmButton = document.getElementById('popup-confirm');
        const popupErrorMessage = document.getElementById('popup-error');

        const correctPassword = "0407"; 

        const questionsPerPage = 10; 
        let currentPage = 0;
        let pageScores = []; 
        let pageAttempted = []; 

        function initializeQuizData() {
            questions.forEach(q => {
                q.userAnswer = null;
                q.isCorrect = null;
                q.attemptedThisSession = false; 
                if (q.answer && q.answer.includes(';')) {
                    q.answersArray = q.answer.split(';');
                } else if (q.answer) {
                    q.answersArray = [q.answer];
                } else {
                    q.answersArray = [];
                }
            });
            const numPages = Math.ceil(questions.length / questionsPerPage);
            pageAttempted = new Array(numPages).fill(false);
            pageScores = new Array(numPages).fill(0);
        }


        function renderQuestionsForPage(page) {
            quizElement.innerHTML = ''; 
            currentPage = page;

            const start = page * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            pageInfoElement.textContent = `총 ${questions.length}문제 중 ${start + 1} - ${end}번 문제`;


            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = document.createElement('div');
                questionCard.classList.add('question-card');
                questionCard.id = `question-${q.id}`;

                const questionText = document.createElement('p');
                questionText.classList.add('question-text');
                let questionHTML = q.text;
                if (q.answersArray && q.answersArray.length > 1) { 
                    let blankCount = 0;
                    questionHTML = q.text.replace(/(\(\s*(?:[^)]*)\s*\))/g, (match) => {
                        blankCount++;
                        return `<span class="blank-emphasis">( ${"&nbsp;&nbsp;&nbsp;".repeat(q.answersArray[blankCount-1] ? q.answersArray[blankCount-1].length/2 +1 : 3)} )</span>`;
                    });
                } else { 
                     questionHTML = q.text.replace(/(\(\s*(?:[^)]*)\s*\))/g, '<span class="blank-emphasis">( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</span>');
                }
                questionText.innerHTML = questionHTML; 
                questionCard.appendChild(questionText);

                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options');

                q.options.forEach(option => {
                    const optionId = `q${String(q.id).replace(/[^a-zA-Z0-9]/g, '')}-option-${option.replace(/[^a-zA-Z0-9ㄱ-ㅎㅏ-ㅣ가-힣$]/g, '')}`;
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.id = optionId;
                    radioInput.name = `question-${q.id}`; 
                    radioInput.value = option; 
                    radioInput.classList.add('option-input', 'hidden');
                    if (q.userAnswer === option) radioInput.checked = true; 
                    if (pageAttempted[currentPage]) radioInput.disabled = true;

                    const optionLabel = document.createElement('label');
                    optionLabel.htmlFor = optionId;
                    optionLabel.innerHTML = option.includes(';') ? option.split(';').join(', ') : option; 
                    optionLabel.classList.add('option-label');
                    if (pageAttempted[currentPage]) optionLabel.classList.add('opacity-70', 'cursor-not-allowed');

                    optionsContainer.appendChild(radioInput);
                    optionsContainer.appendChild(optionLabel);
                });
                questionCard.appendChild(optionsContainer);

                const feedbackElement = document.createElement('div');
                feedbackElement.classList.add('feedback');
                feedbackElement.style.display = 'none'; 
                questionCard.appendChild(feedbackElement);
                
                if (pageAttempted[currentPage] && q.attemptedThisSession) {
                    showFeedbackForQuestion(q, questionCard);
                }
                quizElement.appendChild(questionCard);
            });
            
            const numPages = Math.ceil(questions.length / questionsPerPage);
            if (numPages > 1) {
                paginationControlsElement.style.display = 'flex';
                renderPaginationControls();
            } else {
                paginationControlsElement.style.display = 'none';
            }


            submitPageButton.disabled = pageAttempted[currentPage];
            if (pageAttempted[currentPage]) {
                submitPageButton.textContent = '채점 완료';
                scoreSectionElement.style.display = 'block'; 
                updateScoreDisplay(); 
                showMotivationalQuote(); 
            } else {
                submitPageButton.textContent = '이번 페이지 채점하기'; 
                motivationalQuoteElement.style.display = 'none'; 
                if (questionsOnPage.length > 0) { 
                     scoreSectionElement.style.display = 'none';
                } else { 
                     scoreSectionElement.style.display = 'block';
                     currentPageScoreTextElement.textContent = '이번 페이지에 문제가 없습니다.';
                     totalScoreTextElement.textContent = '';
                }
            }
        }
        
        function showFeedbackForQuestion(question, questionCard) {
            const feedbackElement = questionCard.querySelector('.feedback');
            if (!feedbackElement) return;

            feedbackElement.innerHTML = ''; 
            const correctAnswerText = question.answersArray.join(', ');

            if (question.isCorrect) {
                feedbackElement.innerHTML = '<strong class="font-semibold">정답입니다!</strong> 🎉';
                feedbackElement.className = 'feedback correct';
            } else {
                feedbackElement.innerHTML = `<strong class="font-semibold">오답입니다.</strong> 정답은 "<span class="font-bold text-red-700">${correctAnswerText}</span>"입니다.`;
                feedbackElement.className = 'feedback incorrect';
            }

            const explanationElement = document.createElement('p');
            explanationElement.classList.add('explanation');
            explanationElement.innerHTML = `<strong class="font-semibold">해설:</strong> ${question.explanation}`; 
            feedbackElement.appendChild(explanationElement);
            feedbackElement.style.display = 'block';
        }

        function renderPaginationControls() {
            paginationControlsElement.innerHTML = '';
            const numPages = Math.ceil(questions.length / questionsPerPage);

            const prevButton = document.createElement('button');
            prevButton.textContent = '이전';
            prevButton.disabled = currentPage === 0;
            prevButton.onclick = () => renderQuestionsForPage(currentPage - 1);
            paginationControlsElement.appendChild(prevButton);

            for (let i = 0; i < numPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i + 1;
                pageButton.classList.add('page-number');
                if (i === currentPage) {
                    pageButton.classList.add('current');
                }
                pageButton.onclick = () => renderQuestionsForPage(i);
                paginationControlsElement.appendChild(pageButton);
            }

            const nextButton = document.createElement('button');
            nextButton.textContent = '다음';
            nextButton.disabled = currentPage === numPages - 1;
            nextButton.onclick = () => renderQuestionsForPage(currentPage + 1);
            paginationControlsElement.appendChild(nextButton);
        }

        function showMotivationalQuote() {
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            motivationalQuoteElement.textContent = motivationalQuotes[randomIndex];
            motivationalQuoteElement.style.display = 'block';
        }

        submitPageButton.addEventListener('click', () => {
            if (pageAttempted[currentPage]) return; 

            let scoreForThisPage = 0;
            
            const start = currentPage * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = quizElement.children[indexOnPage]; 
                const selectedOptionInput = questionCard.querySelector(`input[name="question-${q.id}"]:checked`);
                
                q.attemptedThisSession = true;

                if (selectedOptionInput) {
                    q.userAnswer = selectedOptionInput.value; 
                    q.isCorrect = (q.userAnswer === q.answer); 
                                        
                    if (q.isCorrect) {
                        scoreForThisPage++; 
                    }
                    showFeedbackForQuestion(q, questionCard);

                    const radioInputs = questionCard.querySelectorAll('input[type="radio"]');
                    radioInputs.forEach(input => input.disabled = true);
                } else {
                    const feedbackElement = questionCard.querySelector('.feedback');
                    feedbackElement.textContent = '답을 선택하지 않았습니다.';
                    feedbackElement.className = 'feedback incorrect';
                    feedbackElement.style.display = 'block';
                    q.isCorrect = false; 
                }
            });
            
            pageScores[currentPage] = scoreForThisPage;
            pageAttempted[currentPage] = true;
            submitPageButton.disabled = true;
            submitPageButton.textContent = '채점 완료';
            
            scoreSectionElement.style.display = 'block';
            updateScoreDisplay();
            showMotivationalQuote(); 

            const quizContainerElement = document.querySelector('.quiz-container');
            if (quizContainerElement) {
                quizContainerElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });

        function updateScoreDisplay() {
            const questionsOnThisPageCount = Math.min(questionsPerPage, questions.length - (currentPage * questionsPerPage)); 
            currentPageScoreTextElement.textContent = `이번 페이지 점수: ${pageScores[currentPage]} / ${questionsOnThisPageCount}`;
            
            let currentTotalScore = 0;
            let currentTotalAttemptedQuestions = 0;
            for(let i=0; i < pageAttempted.length; i++){
                if(pageAttempted[i]){
                    const start = i * questionsPerPage;
                    const end = Math.min(start + questionsPerPage, questions.length);
                    currentTotalAttemptedQuestions += (end-start);
                    currentTotalScore += pageScores[i];
                }
            }

            const quizTitleElement = document.querySelector('h1'); 
            let quizMainTitle = "현재 단원";
            if (quizTitleElement) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = quizTitleElement.innerHTML; 
                quizMainTitle = tempDiv.textContent || tempDiv.innerText || "";
                const titleParts = quizMainTitle.split('(');
                if (titleParts.length > 0) {
                    quizMainTitle = titleParts[0].trim();
                }
            }
            
            if (quizMainTitleDisplayElement) { 
                quizMainTitleDisplayElement.textContent = quizMainTitle;
            }

            if (currentTotalAttemptedQuestions > 0) {
                 totalScoreTextElement.style.display = 'block'; 
                 totalScoreTextElement.textContent = `총 누적 점수: ${currentTotalScore} / ${currentTotalAttemptedQuestions}`;
            } else {
                 totalScoreTextElement.style.display = 'none'; 
            }
        }
        
        // 팝업 기능
        window.onload = () => {
            if (welcomePopup) {
                // 각 퀴즈 페이지마다 고유한 sessionStorage 키 사용
                const popupSessionKey = 'appiaQuizPasswordEntered_elements_periodicity_1_76'; 
                const popupShownThisSession = sessionStorage.getItem(popupSessionKey); 
                if (!popupShownThisSession) { 
                    welcomePopup.classList.add('show');
                } else {
                    initializeQuizData();
                    renderQuestionsForPage(0);
                }
            } else { 
                initializeQuizData();
                renderQuestionsForPage(0);
            }
        };

        if (popupConfirmButton) {
            popupConfirmButton.addEventListener('click', () => {
                if (popupPasswordInput.value === correctPassword) {
                    if (welcomePopup) {
                        welcomePopup.classList.remove('show');
                    }
                    const popupSessionKey = 'appiaQuizPasswordEntered_elements_periodicity_1_76';
                    sessionStorage.setItem(popupSessionKey, 'true'); 
                    initializeQuizData(); 
                    renderQuestionsForPage(0);
                } else {
                    if (popupErrorMessage) {
                        popupErrorMessage.textContent = "비밀번호가 틀렸습니다. 다시 시도해주세요.";
                    }
                    popupPasswordInput.value = ''; 
                    popupPasswordInput.focus(); 
                }
            });
        }
        
        if (popupPasswordInput) {
            popupPasswordInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); 
                    popupConfirmButton.click();
                }
            });
        }

    </script>
</body>
</html>
