<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2.2.1 물질과 규칙성 - 지각과 생명체를 구성하는 물질 (1-75번)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: #f0f4f8;
        }
        .quiz-container {
            max-width: 800px;
            margin: 2rem auto;
            padding: 1.5rem;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .question-card {
            background-color: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .question-text {
            font-size: 1.1rem;
            font-weight: 500;
            color: #2d3748;
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        .question-text .blank-emphasis { 
            font-weight: bold;
            color: #3b82f6; 
        }
        .option-label {
            display: block;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border: 1px solid #cbd5e0;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s, border-color 0.2s;
            background-color: #f7fafc;
        }
        .option-label:hover {
            background-color: #e2e8f0;
        }
        .option-input:checked + .option-label {
            background-color: #4299e1;
            color: white;
            border-color: #2b6cb0;
        }
        .feedback {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 6px;
            font-size: 0.95rem;
        }
        .feedback.correct {
            background-color: #c6f6d5;
            color: #2f855a;
            border: 1px solid #9ae6b4;
        }
        .feedback.incorrect {
            background-color: #fed7d7;
            color: #c53030;
            border: 1px solid #fbb6ce;
        }
        .explanation {
            margin-top: 0.5rem;
            font-size: 0.9rem;
            color: #4a5568;
            line-height: 1.5;
        }
        .action-button {
            background-color: #4a5568;
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            border: none;
            margin-top: 1rem;
            margin-right: 0.5rem;
        }
        .action-button:hover:not(:disabled) {
            background-color: #2d3748;
        }
        .action-button:disabled {
            background-color: #a0aec0;
            cursor: not-allowed;
        }
        .pagination-controls {
            display: flex; 
            justify-content: center;
            align-items: center;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .pagination-controls button, .pagination-controls span {
            margin: 0 0.25rem;
            padding: 0.5rem 0.75rem;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            background-color: #fff;
            cursor: pointer;
        }
        .pagination-controls button:disabled {
            background-color: #e2e8f0;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .pagination-controls .page-number.current {
            background-color: #4299e1;
            color: white;
            border-color: #2b6cb0;
            font-weight: bold;
        }
        .score-section {
            margin-top: 1.5rem;
            padding: 1.5rem; 
            background-color: #e9f5ff;
            border-radius: 8px;
            text-align: left;
        }
        .score-text {
            font-size: 1.1rem;
            font-weight: 500;
            color: #1a202c;
            margin-bottom: 0.5rem;
        }
        .quiz-title-in-score {
            font-size: 1.1rem; 
            font-weight: bold;
            color: #1e40af; 
            margin-bottom: 0.75rem; 
        }
        .motivational-quote { 
            font-size: 1rem;
            font-style: italic;
            color: #374151; 
            margin-top: 1.5rem; 
            padding-top: 1rem;
            border-top: 1px dashed #cbd5e0; 
            text-align: center;
        }
        h1 { 
            font-size: 1.8rem;
            font-weight: 700;
            color: #1a202c;
            text-align: center;
            margin-bottom: 1.5rem;
        }
        .page-info {
            text-align: center;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #4a5568;
        }

        /* 팝업 스타일 */
        .popup-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); display: flex;
            justify-content: center; align-items: center; z-index: 1000; 
            opacity: 0; visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .popup-overlay.show { opacity: 1; visibility: visible; }
        .popup-content {
            background-color: white; padding: 2.5rem; border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25); text-align: center;
            max-width: 420px; width: 90%;
        }
        .popup-content h2 {
            font-size: 1.75rem; font-weight: 700; color: #1a202c; margin-bottom: 1rem;
        }
        .popup-content p.welcome-message {
            font-size: 1rem; color: #4a5568; margin-bottom: 1.5rem; line-height: 1.6;
        }
        .popup-password-input {
            width: 100%; padding: 0.75rem; margin-bottom: 1rem;
            border: 1px solid #cbd5e0; border-radius: 6px; font-size: 1rem;
            box-sizing: border-box; 
        }
        .popup-confirm-btn {
            background-color: #3b82f6; color: white; padding: 0.75rem 1.5rem;
            border-radius: 8px; font-weight: 500; cursor: pointer;
            transition: background-color 0.2s; border: none; width: 100%;
            font-size: 1rem;
        }
        .popup-confirm-btn:hover { background-color: #2563eb; }
        .popup-error-message {
            color: #ef4444; font-size: 0.875rem; margin-top: 0.75rem;
            min-height: 1.25rem; 
        }
    </style>
</head>
<body>
    <div id="welcome-popup" class="popup-overlay">
        <div class="popup-content">
            <h2>Appia 과학학원</h2>
            <p class="welcome-message">유선종 선생님의 학습 자료입니다.<br>비밀번호를 입력해주세요.</p>
            <input type="password" id="popup-password" class="popup-password-input" placeholder="비밀번호">
            <button id="popup-confirm" class="popup-confirm-btn">확인</button>
            <p id="popup-error" class="popup-error-message"></p>
        </div>
    </div>
    <div class="quiz-container">
        <h1>2.2.1 물질과 규칙성 - 지각과 생명체를 구성하는 물질 (80p ~ 87p)</h1>
        <div class="page-info" id="page-info"></div>
        <div id="quiz">
            </div>
        <div class="pagination-controls" id="pagination-controls">
            </div>
        <button id="submit-page-btn" class="action-button w-full sm:w-auto mx-auto block">이번 페이지 채점하기</button>
        <div class="score-section" id="score-section" style="display: none;">
            <p class="score-text quiz-title-in-score" id="quiz-main-title-in-score"></p> 
            <p class="score-text" id="current-page-score-text"></p>
            <p class="score-text" id="total-score-text"></p>
            <p class="motivational-quote" id="motivational-quote" style="display: none;"></p> 
        </div>
    </div>

    <script>
        // 문제 데이터 (PDF "2.2.1 물질과 규칙성-지각과 생명체를 구성하는 물질.pdf" 기준)
        const questions = [
            {
                id: 1, type: 'fill-in', text: "1. 지각이나 생명체를 구성하는 물질은 물질을 구성하는 단위 역할인 기본 (   )가 반복적으로 결합해 형성된다.",
                answer: "단위체", options: ["중합체", "원소", "단위체", "분자"],
                explanation: "지각이나 생명체를 구성하는 많은 거대 분자들은 작은 기본 단위체(모노머)들이 반복적으로 결합하여 만들어진 중합체(폴리머)입니다."
            },
            {
                id: 2, type: 'fill-in', text: "2. (   )을 구성하는 암석은 (   )로 이루어져 있으며, 광물 대부분은 (   )와 (   )가 결합한 (   )를 기본 단위체로 한다.",
                answer: "지각;광물;산소;규소;규산염사면체", options: ["맨틀;원소;탄소;수소;탄화수소", "지각;광물;산소;규소;규산염사면체", "핵;금속;철;니켈;합금", "생명체;세포;질소;인;아미노산"],
                explanation: "지각은 다양한 암석으로, 암석은 여러 종류의 광물로 이루어져 있습니다. 지각을 구성하는 광물의 대부분은 산소(O)와 규소(Si)가 결합하여 만든 규산염 사면체(SiO<sub>4</sub><sup>4-</sup>)를 기본 구조로 하는 규산염 광물입니다."
            },
            {
                id: 3, type: 'fill-in', text: "3. (   )는 규소 원자 (   )개와 산소 원자 (   )개로 이루어진다.",
                answer: "규산염사면체;1;4", options: ["물분자;2;1", "이산화탄소;1;2", "규산염사면체;1;4", "암모니아;1;3"],
                explanation: "규산염 사면체는 중심에 규소(Si) 원자 1개가 있고, 그 주위를 4개의 산소(O) 원자가 정사면체 형태로 둘러싸고 있는 구조 (SiO<sub>4</sub>)입니다. 전체적으로 SiO<sub>4</sub><sup>4-</sup> 이온 형태를 띱니다."
            },
            {
                id: 4, type: 'ox', text: "4. 지각을 구성하는 모든 광물은 규산염 사면체로 이루어져 있다.",
                answer: "X", options: ["O", "X"],
                explanation: "지각을 구성하는 광물의 대부분은 규산염 광물이지만, 산화 광물, 황화 광물, 탄산염 광물 등 규산염 사면체 구조가 아닌 광물들도 존재합니다."
            },
            {
                id: 5, type: 'fill-in', text: "5. 규산염 사면체는 다른 규산염 사면체와 (   )를 공유하면서 결합한다.",
                answer: "산소", options: ["규소", "전자", "산소", "양이온"],
                explanation: "규산염 사면체들은 꼭짓점에 있는 산소 원자를 다른 규산염 사면체와 공유하면서 다양한 방식으로 결합하여 여러 종류의 규산염 광물을 만듭니다."
            },
            {
                id: 6, type: 'ox', text: "6. 규산염 사면체가 연결 될 때 항상 대칭을 이룬다.",
                answer: "O", options: ["X", "O"], // PDF 답안 기준
                explanation: "규산염 사면체들이 결합하여 광물을 형성할 때는 특정한 규칙에 따라 대칭적인 결정 구조를 이루는 경향이 있습니다. (주: 실제로는 매우 복잡하고 다양한 구조가 가능합니다.)"
            },
            {
                id: 7, type: 'ox', text: "7. 화강암과 현무암 같이 화산활동으로 만들어진 광물들도 규산염 광물이다.",
                answer: "O", options: ["O", "X"],
                explanation: "화강암(주로 석영, 장석, 흑운모)과 현무암(주로 감람석, 휘석, 사장석)을 이루는 주요 광물들은 대부분 규산염 광물입니다."
            },
            {
                id: 8, type: 'fill-in', text: "8. 기둥 모양의 결정을 갖는 광물에는 (   )과 (   )이 있다.",
                answer: "휘석;각섬석", options: ["석영;장석", "흑운모;백운모", "휘석;각섬석", "감람석;석류석"],
                explanation: "휘석은 규산염 사면체가 단일 사슬 구조로 결합하여 주로 짧은 기둥 모양을, 각섬석은 이중 사슬 구조로 결합하여 주로 긴 기둥 모양의 결정을 이룹니다."
            },
            {
                id: 9, type: 'fill-in', text: "9. 규산염 사면체가 한 줄로 길게 결합한 형태인 광물은 (   )이다.",
                answer: "휘석", options: ["각섬석", "흑운모", "감람석", "휘석"],
                explanation: "휘석은 규산염 사면체들이 산소 2개를 공유하며 한 줄의 사슬 모양으로 길게 결합한 단일 사슬 구조를 가집니다."
            },
            {
                id: 10, type: 'fill-in', text: "10. 규산염 사면체가 두 줄로 길게 결합한 형태인 광물은 (   )이다.", // PDF '사면세' 오타 수정
                answer: "각섬석", options: ["휘석", "흑운모", "석영", "각섬석"],
                explanation: "각섬석은 규산염 사면체들이 산소 2개 또는 3개를 공유하며 두 줄의 사슬 모양으로 길게 결합한 이중 사슬 구조를 가집니다."
            },
            {
                id: 11, type: 'fill-in', text: "11. 규산염 사면체가 얇은 판 모양으로 결합한 형태인 광물은 (   )이다.",
                answer: "흑운모", options: ["석영", "장석", "감람석", "흑운모"],
                explanation: "흑운모나 백운모 같은 운모류는 규산염 사면체들이 산소 3개를 공유하며 얇은 판 모양으로 무한히 넓게 결합한 판상 구조(층상 구조)를 가집니다."
            },
            {
                id: 12, type: 'fill-in', text: "12. 규산염 사면체가 입체적으로 결합한 형태인 광물은 (   )이다.",
                answer: "석영", options: ["휘석", "흑운모", "석영", "감람석"],
                explanation: "석영이나 장석은 규산염 사면체들이 모든 산소 원자(4개)를 이웃한 사면체와 공유하며 3차원적인 망상 구조(입체 구조)를 이룹니다."
            },
            {
                id: 13, type: 'fill-in', text: "13. 독립형 구조는 규산염 사면체가 독립적으로 (   )과 결합하여 광물을 이룬다.",
                answer: "양이온", options: ["음이온", "다른 사면체", "양이온", "물 분자"],
                explanation: "독립형 구조(예: 감람석)에서는 규산염 사면체(SiO<sub>4</sub><sup>4-</sup>)들이 서로 산소를 공유하지 않고 독립적으로 존재하며, Mg<sup>2+</sup>나 Fe<sup>2+</sup> 같은 양이온들과 이온 결합하여 광물을 형성합니다."
            },
            {
                id: 14, type: 'fill-in', text: "14. 독립형 구조는 공유 산소 수가 (   )개로 (   )에 약하다.",
                answer: "0;풍화", options: ["1;압력", "0;풍화", "2;열", "4;물"],
                explanation: "독립형 구조는 규산염 사면체 간에 공유하는 산소 원자가 없어 결합력이 상대적으로 약하며, 화학적 풍화 작용에 약한 편입니다."
            },
            {
                id: 15, type: 'fill-in', text: "15. (   )구조는 최대 공유 산소 수가 (   )개로 얇은 판 모양으로 (   )진다.",
                answer: "판상;3;쪼개", options: ["망상;4;깨", "단일사슬;2;휘어", "판상;3;쪼개", "독립형;0;부서"],
                explanation: "판상 구조(예: 흑운모)는 각 규산염 사면체가 3개의 산소를 공유하여 2차원적인 판을 이루며, 판과 판 사이의 결합력이 약해 얇게 쪼개지는 특성이 있습니다."
            },
            {
                id: 16, type: 'fill-in', text: "16. (   )구조는 풍화에 가장 (   )하며, 최대 (   )개의 산소를 공유하며 조각조각 (   )진다.",
                answer: "망상;강;4;깨", options: ["판상;약;3;쪼개", "망상;강;4;깨", "독립형;매우 약;0;부서", "사슬;보통;2;휘어"],
                explanation: "망상 구조(예: 석영)는 모든 산소 원자(4개)를 공유하여 3차원적으로 매우 단단하게 결합되어 있어 화학적 풍화에 가장 강하며, 일정한 방향으로 쪼개지기보다는 불규칙하게 깨지는 특성(깨짐)을 보입니다."
            },
            {
                id: 17, type: 'fill-in', text: "17. 규산염 광물의 결합 (   )에 따라 광물의 특성이 다르다.",
                answer: "구조", options: ["색깔", "밀도", "구조", "원산지"],
                explanation: "규산염 사면체의 결합 방식(독립형, 단일 사슬, 이중 사슬, 판상, 망상 구조 등)에 따라 규산염 광물의 결정 모양, 쪼개짐과 깨짐, 경도, 풍화에 대한 저항성 등 다양한 물리적, 화학적 특성이 달라집니다."
            },
            {
                id: 18, type: 'fill-in', text: "18. 규산염 사면체의 결합이 (   )할수록 안정하여 풍화에 강하다.",
                answer: "복잡", options: ["단순", "느슨", "복잡", "불규칙"],
                explanation: "일반적으로 규산염 사면체 간에 공유하는 산소 원자 수가 많을수록(즉, 결합 구조가 복잡하고 3차원적으로 발달할수록, 예: 망상 구조) 결합이 강해져 화학적으로 안정하며 풍화에 대한 저항성이 커집니다."
            },
            {
                id: 19, type: 'fill-in', text: "19. 피부, 근육, 혈액 등 사람의 몸을 구성하는 데 필수적인 물질은 (   )이다.",
                answer: "단백질", options: ["탄수화물", "지방", "핵산", "단백질"],
                explanation: "단백질은 생명체의 몸을 구성하는 주요 성분(세포, 조직, 기관 등)이며, 효소, 호르몬, 항체 등의 형태로 다양한 생명 활동을 조절하는 필수적인 유기물입니다."
            },
            {
                id: 20, type: 'fill-in', text: "20. 단백질의 기본 단위체는 (   )이며 (   )종류가 있다.",
                answer: "아미노산;20", options: ["뉴클레오타이드;4", "아미노산;20", "단당류;여러", "지방산;몇몇"],
                explanation: "단백질은 아미노산이라는 기본 단위체가 펩타이드 결합으로 길게 연결된 고분자 화합물입니다. 자연계에는 수백 종류의 아미노산이 있지만, 생명체의 단백질을 구성하는 주요 아미노산은 약 20종류입니다."
            },
            {
                id: 21, type: 'fill-in', text: "21. (   )은 몸속에서 일어나는 여러 가지 (   )반응을 조절해 생명활동이 원활하게 일어나도록 도와준다.",
                answer: "단백질;화학", options: ["물;물리", "무기염류;삼투", "단백질;화학", "비타민;생리"],
                explanation: "단백질의 일종인 효소는 생체 내 화학 반응의 촉매 역할을 하여 물질대사가 원활하게 일어나도록 돕습니다. 또한 호르몬, 항체 등도 단백질로 구성되어 생명 활동에 중요합니다."
            },
            {
                id: 22, type: 'fill-in', text: "22. 아미노산끼리의 결합을 (   ) 결합이라 하며, 길게 연결 된 것을 (   )라 한다.",
                answer: "펩타이드;폴리펩타이드", options: ["글리코사이드;다당류", "에스터;지질", "펩타이드;폴리펩타이드", "수소;이중나선"],
                explanation: "하나의 아미노산의 카복실기(-COOH)와 다른 아미노산의 아미노기(-NH<sub>2</sub>) 사이에서 물 분자 하나가 빠져나오면서 형성되는 공유 결합을 펩타이드 결합이라고 합니다. 많은 아미노산이 펩타이드 결합으로 연결된 사슬을 폴리펩타이드라고 합니다."
            },
            {
                id: 23, type: 'fill-in', text: "23. 단백질의 종류마다 폴리펩타이드의 (   )가 다르다.",
                answer: "입체구조", options: ["색깔", "밀도", "입체구조", "pH"],
                explanation: "단백질은 아미노산의 종류, 수, 배열 순서에 따라 고유한 1차 구조를 가지며, 이 폴리펩타이드 사슬이 접히고 꼬여 특정한 3차원 입체 구조를 형성합니다. 이 입체 구조에 따라 단백질의 기능이 결정됩니다."
            },
            {
                id: 24, type: 'ox', text: "24. 펩타이드 결합은 이온 결합의 한 종류이다.",
                answer: "X", options: ["O", "X"],
                explanation: "펩타이드 결합은 아미노산의 카복실기와 아미노기 사이에서 전자를 공유하며 형성되는 공유 결합의 일종입니다. 이온 결합과는 다릅니다."
            },
            {
                id: 25, type: 'fill-in', text: "25. 펩타이드 결합이 일어나면 항상 (   )분자 1개가 빠져나간다.",
                answer: "물", options: ["이산화탄소", "산소", "수소", "물"],
                explanation: "펩타이드 결합은 한 아미노산의 카복실기(-COOH)에서 -OH가, 다른 아미노산의 아미노기(-NH<sub>2</sub>)에서 -H가 빠져나와 물(H<sub>2</sub>O) 분자 1개가 형성되면서 두 아미노산이 연결되는 탈수 축합 반응입니다."
            },
            {
                id: 26, type: 'fill-in', text: "26. 아미노산이 10개면 펩타이드 결합은 (   )번, 빠져나간 물 분자는 (   )개",
                answer: "9;9", options: ["10;10", "8;8", "9;9", "10;9"],
                explanation: "n개의 아미노산이 일렬로 연결되어 폴리펩타이드를 형성할 때, 펩타이드 결합의 수는 (n-1)개이고, 빠져나오는 물 분자의 수도 (n-1)개입니다. 따라서 아미노산이 10개면 펩타이드 결합은 9번, 물 분자는 9개 빠져나옵니다."
            },
            {
                id: 27, type: 'fill-in', text: "27. [복자] 동물의 피부, 머리카락 등을 구성하는 탄소화합물을 (   )이라 한다.",
                answer: "단백질", options: ["지질", "탄수화물", "핵산", "단백질"],
                explanation: "동물의 피부(콜라젠, 엘라스틴), 머리카락, 손톱(케라틴) 등의 주성분은 단백질입니다. 단백질은 탄소를 기본 골격으로 하는 탄소 화합물입니다."
            },
            {
                id: 28, type: 'fill-in', text: "28. [복자] 동물의 세포막 등을 구성하는 탄소화합물을 (   )이라 한다.",
                answer: "지질", options: ["단백질", "탄수화물", "지질", "핵산"],
                explanation: "동물 세포막의 주성분은 인지질과 단백질입니다. 인지질은 글리세롤에 지방산 2개와 인산기가 결합한 형태로, 지질의 일종이며 탄소 화합물입니다."
            },
            {
                id: 29, type: 'fill-in', text: "29. [복자] 식물의 광합성에 의해 생성되는 (   )의 단위인 탄소화합물을 (   )이라 한다.",
                answer: "포도당;탄수화물", options: ["아미노산;단백질", "지방산;지질", "포도당;탄수화물", "뉴클레오타이드;핵산"],
                explanation: "식물의 광합성 결과 생성되는 포도당(C<sub>6</sub>H<sub>12</sub>O<sub>6</sub>)은 단당류의 일종이며, 탄수화물의 기본 단위가 됩니다. 탄수화물은 탄소, 수소, 산소로 이루어진 탄소 화합물입니다."
            },
            {
                id: 30, type: 'fill-in', text: "30. [복자] 탄소의 원자가 전자는 (   )개로 최대 (   )개의 공유 결합을 한다.",
                answer: "4;4", options: ["2;2", "6;2", "4;4", "1;4"],
                explanation: "탄소(C)는 원자번호 6번으로, 전자 배치는 (2, 4)입니다. 가장 바깥 전자껍질에 4개의 원자가 전자를 가지고 있어, 다른 원자와 최대 4개의 공유 결합을 형성하여 옥텟 규칙을 만족하려 합니다."
            },
            {
                id: 31, type: 'ox', text: "31. [복자] 탄소는 원자끼리 거의 무한대로 결합할 수 있다.",
                answer: "O", options: ["X", "O"],
                explanation: "탄소 원자는 다른 탄소 원자와 단일 결합, 이중 결합, 삼중 결합 등 다양한 방식으로 강하게 결합할 수 있으며, 사슬 모양, 가지 달린 모양, 고리 모양 등 거의 무한에 가까운 다양한 길이와 구조의 탄소 골격을 형성할 수 있습니다. 이는 유기 화합물의 다양성의 근간이 됩니다."
            },
            {
                id: 32, type: 'fill-in', text: "32. [복자] C, H, O로 이루어진 탄소화합물에는 (   )과 (   )이 있다.",
                answer: "탄수화물;지질", options: ["단백질;핵산", "아미노산;뉴클레오타이드", "탄수화물;지질", "물;이산화탄소"],
                explanation: "탄수화물(예: 포도당 C<sub>6</sub>H<sub>12</sub>O<sub>6</sub>)과 지질(예: 지방, 인지질)은 주로 탄소(C), 수소(H), 산소(O) 세 가지 원소로 구성된 탄소 화합물입니다."
            },
            {
                id: 33, type: 'fill-in', text: "33. [복자] C, H, O, N, (S) 으로 이루어진 탄소화합물에는 (   )이 있다.",
                answer: "단백질", options: ["탄수화물", "지질", "핵산", "단백질"],
                explanation: "단백질은 탄소(C), 수소(H), 산소(O), 질소(N)를 기본 구성 원소로 하며, 일부 아미노산(예: 메티오닌, 시스테인)은 황(S)을 포함하기도 합니다."
            },
            {
                id: 34, type: 'fill-in', text: "34. [복자] C, H, O, N, P로 이루어진 탄소화합물에는 (   )이 있다.",
                answer: "핵산", options: ["단백질", "탄수화물", "핵산", "지질"],
                explanation: "핵산(DNA, RNA)은 탄소(C), 수소(H), 산소(O), 질소(N), 그리고 인(P)을 주요 구성 원소로 하는 고분자 화합물입니다. 인은 핵산의 기본 단위인 뉴클레오타이드의 인산기에 포함되어 있습니다."
            },
            {
                id: 35, type: 'fill-in', text: "35. [복자] 호르몬, 헤모글로빈 등의 주성분은 (   )이다.",
                answer: "단백질", options: ["지질", "탄수화물", "핵산", "단백질"],
                explanation: "많은 종류의 호르몬(예: 인슐린, 성장 호르몬)과 혈액에서 산소를 운반하는 헤모글로빈은 단백질로 이루어져 있습니다. (일부 호르몬은 스테로이드계 지질이기도 합니다.)"
            },
            {
                id: 36, type: 'ox', text: "36. [복자] 아미노산끼리 결합 할 때 전자를 공유한다.",
                answer: "O", options: ["O", "X"],
                explanation: "아미노산끼리의 결합인 펩타이드 결합은 한 아미노산의 카복실기와 다른 아미노산의 아미노기 사이에서 형성되는 공유 결합입니다."
            },
            {
                id: 37, type: 'fill-in', text: "37. [복자] 단백질, 핵산, 탄수화물과 같이 100개 이상의 원자로 구성된 탄소 화합물을 (   ) 화합물이라 한다.",
                answer: "고분자", options: ["저분자", "단위체", "이온성", "고분자"],
                explanation: "고분자 화합물은 분자량이 매우 큰 화합물로, 수많은 작은 단위체(단량체)들이 반복적으로 결합하여 이루어집니다. 단백질, 핵산, 다당류(탄수화물의 일종) 등이 대표적인 생체 고분자 화합물입니다."
            },
            {
                id: 38, type: 'ox', text: "38. 단백질의 입체구조가 변하면 기능도 변한다.",
                answer: "O", options: ["X", "O"],
                explanation: "단백질의 기능은 특정한 3차원 입체 구조에 의해 결정됩니다. 열, pH 변화, 화학 물질 등에 의해 단백질의 입체 구조가 변형(변성)되면 고유한 기능을 잃어버리게 됩니다."
            },
            {
                id: 39, type: 'ox', text: "39. 아미노산은 고분자 물질이다.",
                answer: "X", options: ["O", "X"],
                explanation: "아미노산은 단백질을 구성하는 기본 단위체(단량체, monomer)로, 상대적으로 작은 분자입니다. 아미노산이 많이 연결된 폴리펩타이드나 단백질이 고분자 물질입니다."
            },
            {
                id: 40, type: 'fill-in', text: "40. 효소의 주성분인 탄소화합물은 (   )이다.",
                answer: "단백질", options: ["핵산", "지질", "탄수화물", "단백질"],
                explanation: "효소는 생체 내 화학 반응을 촉매하는 물질로, 대부분 단백질로 이루어져 있습니다. (일부 RNA도 효소 활성을 가짐 - 리보자임)"
            },
            {
                id: 41, type: 'fill-in', text: "41. [복자] 포도당의 주성분인 탄소 화합물은 (   )이다.", // PDF에 319번과 중복되는 내용으로 보임. 여기서는 41번으로 유지.
                answer: "탄수화물", options: ["단백질", "지질", "탄수화물", "핵산"],
                explanation: "포도당(C<sub>6</sub>H<sub>12</sub>O<sub>6</sub>)은 탄소, 수소, 산소로 이루어진 단당류이며, 탄수화물의 한 종류입니다."
            },
            {
                id: 42, type: 'fill-in', text: "42. 아미노산의 (   ), (   ), (   )에 따라 서로 다른 단백질이 형성된다.",
                answer: "수;종류;배열순서", options: ["크기;모양;색깔", "전하;pH;온도", "수;종류;배열순서", "결합방식;길이;무게"],
                explanation: "단백질의 1차 구조는 아미노산의 종류, 개수(수), 그리고 연결된 순서(배열 순서)에 의해 결정되며, 이는 단백질의 전체적인 입체 구조와 기능을 결정하는 가장 기본적인 정보입니다."
            },
            {
                id: 43, type: 'fill-in', text: "43. 헤모글로빈의 주성분은 (   )로 주로 (   )를 조직 세포로 운반한다.",
                answer: "단백질;산소", options: ["지질;이산화탄소", "탄수화물;포도당", "단백질;산소", "핵산;유전정보"],
                explanation: "헤모글로빈은 적혈구에 들어있는 단백질로, 폐에서 산소와 결합하여 혈액을 통해 조직 세포로 산소를 운반하는 중요한 역할을 합니다."
            },
            {
                id: 44, type: 'fill-in', text: "44. 케라틴의 주성분은 (   )로 (   ), (   )등을 구성한다.",
                answer: "단백질;머리카락;손톱", options: ["지질;피부;지방", "탄수화물;뼈;근육", "핵산;세포핵;DNA", "단백질;머리카락;손톱"],
                explanation: "케라틴은 구조 단백질의 일종으로, 머리카락, 손톱, 발톱, 피부의 각질층, 동물의 뿔이나 깃털 등을 구성하는 주요 성분입니다."
            },
            {
                id: 45, type: 'fill-in', text: "45. 헤모글로빈과 케라틴의 단위체는 (   )으로 같지만, (   )와 (   )가 달라 서로 다른 기능을 한다.",
                answer: "아미노산;종류;배열순서", options: ["뉴클레오타이드;염기;당", "단당류;결합방식;수", "아미노산;종류;배열순서", "지방산;길이;포화도"],
                explanation: "헤모글로빈과 케라틴은 모두 단백질이므로 기본 단위체는 아미노산으로 동일합니다. 하지만 구성하는 아미노산의 종류, 수, 배열 순서가 다르기 때문에 서로 다른 입체 구조를 가지며, 그 결과로 운반 기능(헤모글로빈)과 구조 형성 기능(케라틴)이라는 서로 다른 기능을 수행합니다."
            },
            {
                id: 46, type: 'ox', text: "46. 입체구조가 서로 달라도 모든 단백질은 아미노산의 종류와 배열이 동일하다.",
                answer: "X", options: ["O", "X"],
                explanation: "단백질의 입체 구조는 아미노산의 종류와 배열 순서(1차 구조)에 의해 결정됩니다. 따라서 아미노산의 종류와 배열이 다르면 입체 구조도 달라지고 기능도 달라집니다."
            },
            {
                id: 47, type: 'fill-in', text: "47. 핵산은 생명체를 구성하는 (   )안에 있다.",
                answer: "세포", options: ["혈액", "조직액", "림프", "세포"],
                explanation: "핵산(DNA와 RNA)은 모든 생명체의 세포 안에 존재하며, 유전 정보를 저장하고 전달하는 역할을 합니다. 진핵세포의 경우 DNA는 주로 핵 안에, RNA는 핵과 세포질에 존재합니다."
            },
            {
                id: 48, type: 'fill-in', text: "48. 핵산의 기본 단위체를 (   )라 한다.",
                answer: "뉴클레오타이드", options: ["아미노산", "단당류", "뉴클레오타이드", "지방산"],
                explanation: "핵산(DNA, RNA)은 뉴클레오타이드라는 기본 단위체가 반복적으로 연결된 고분자 화합물입니다."
            },
            {
                id: 49, type: 'fill-in', text: "49. DNA는 (   ), (   ), (   )가 1:1:1로 결합된 단위체를 갖는다.",
                answer: "인산;당;염기", options: ["아미노기;카복실기;곁사슬", "글리세롤;지방산;인산", "인산;당;염기", "탄소;수소;산소"],
                explanation: "DNA를 구성하는 뉴클레오타이드는 인산, 당(디옥시리보스), 염기(아데닌 A, 구아닌 G, 사이토신 C, 타이민 T)가 각각 1개씩 1:1:1의 비율로 결합한 구조입니다."
            },
            {
                id: 50, type: 'fill-in', text: "50. RNA는 인산, 당, 염기가 1:1:1로 결합된 (   )로 이루어져 있다.",
                answer: "뉴클레오타이드", options: ["폴리펩타이드", "다당류", "중성지방", "뉴클레오타이드"],
                explanation: "RNA 역시 DNA와 마찬가지로 인산, 당(리보스), 염기(아데닌 A, 구아닌 G, 사이토신 C, 유라실 U)가 1:1:1로 결합한 뉴클레오타이드를 기본 단위체로 합니다."
            },
            {
                id: 51, type: 'ox', text: "51. DNA의 당의 종류와 RNA의 당의 종류는 같다.",
                answer: "X", options: ["O", "X"],
                explanation: "DNA를 구성하는 당은 디옥시리보스(deoxyribose)이고, RNA를 구성하는 당은 리보스(ribose)입니다. 디옥시리보스는 리보스보다 2번 탄소에 산소 원자 하나가 적습니다."
            },
            {
                id: 52, type: 'fill-in', text: "52. DNA의 당은 (   )이고, 염기에는 (A), (G), (C), (   )가 있다.",
                answer: "디옥시리보스;T", options: ["리보스;U", "디옥시리보스;T", "포도당;A", "과당;G"],
                explanation: "DNA의 뉴클레오타이드에 포함된 당은 디옥시리보스이며, 염기로는 아데닌(A), 구아닌(G), 사이토신(C), 타이민(T) 네 종류가 사용됩니다."
            },
            {
                id: 53, type: 'fill-in', text: "53. RNA의 당은 (   )이고, 염기에는 (A), (G), (C), (   )가 있다.",
                answer: "리보스;U", options: ["디옥시리보스;T", "갈락토스;C", "리보스;U", "엿당;A"],
                explanation: "RNA의 뉴클레오타이드에 포함된 당은 리보스이며, 염기로는 아데닌(A), 구아닌(G), 사이토신(C), 유라실(U) 네 종류가 사용됩니다. DNA의 타이민(T) 대신 유라실(U)을 가집니다."
            },
            {
                id: 54, type: 'fill-in', text: "54. 염기 A를 읽으면 (   )",
                answer: "아데닌", options: ["구아닌", "사이토신", "타이민", "아데닌"],
                explanation: "핵산의 염기 중 A는 아데닌(Adenine)을 나타냅니다."
            },
            {
                id: 55, type: 'fill-in', text: "55. 염기 G를 읽으면 (   )",
                answer: "구아닌", options: ["아데닌", "사이토신", "유라실", "구아닌"],
                explanation: "핵산의 염기 중 G는 구아닌(Guanine)을 나타냅니다."
            },
            {
                id: 56, type: 'fill-in', text: "56. 염기 C를 읽으면 (   )",
                answer: "사이토신", options: ["타이민", "아데닌", "구아닌", "사이토신"],
                explanation: "핵산의 염기 중 C는 사이토신(Cytosine)을 나타냅니다."
            },
            {
                id: 57, type: 'fill-in', text: "57. 염기 T를 읽으면 (   )",
                answer: "타이민", options: ["유라실", "아데닌", "사이토신", "타이민"],
                explanation: "DNA의 염기 중 T는 타이민(Thymine)을 나타냅니다."
            },
            {
                id: 58, type: 'fill-in', text: "58. 염기 U를 읽으면 (   )",
                answer: "유라실", options: ["타이민", "구아닌", "아데닌", "유라실"],
                explanation: "RNA의 염기 중 U는 유라실(Uracil)을 나타냅니다."
            },
            {
                id: 59, type: 'fill-in', text: "59. 뉴클레오타이드들이 여러번 결합하여 길게 이어진 것을 (   ) 뉴클레오타이드 라고 한다.",
                answer: "폴리", options: ["모노", "디", "트리", "폴리"],
                explanation: "많은 수의 뉴클레오타이드가 인산이에스터 결합(phosphodiester bond)으로 길게 연결된 사슬을 폴리뉴클레오타이드라고 합니다. DNA와 RNA가 여기에 해당합니다."
            },
            {
                id: 60, type: 'ox', text: "60. 뉴클레오타이드가 다른 뉴클레오타이드와 결합하는 것은 이온 결합이다.",
                answer: "X", options: ["O", "X"],
                explanation: "뉴클레오타이드들이 연결되어 폴리뉴클레오타이드 가닥을 형성할 때, 한 뉴클레오타이드의 당과 다른 뉴클레오타이드의 인산기 사이에 형성되는 결합은 공유 결합의 일종인 인산이에스터 결합입니다."
            },
            {
                id: 61, type: 'ox', text: "61. 뉴클레오타이드가 다른 뉴클레오타이드와 결합할 때 당과 당끼리 결합한다.",
                answer: "X", options: ["X", "O"],
                explanation: "폴리뉴클레오타이드 사슬에서 뉴클레오타이드들은 한 뉴클레오타이드의 당(3번 탄소의 -OH기)과 다음 뉴클레오타이드의 인산기가 결합하는 방식으로 연결됩니다. 당과 당이 직접 결합하는 것이 아닙니다."
            },
            {
                id: 62, type: 'fill-in', text: "62. 뉴클레오타이드가 다른 뉴클레오타이드와 결합할 때 한 뉴클레오타이드의 (   )과 다른 뉴클레오타이드의 (   )이 결합한다.",
                answer: "당;인산", options: ["인산;염기", "염기;당", "당;인산", "염기;염기"],
                explanation: "폴리뉴클레오타이드 가닥을 형성할 때, 한 뉴클레오타이드의 당(정확히는 당의 3번 탄소에 붙은 수산기)과 인접한 다른 뉴클레오타이드의 인산기가 공유 결합(인산이에스터 결합)을 통해 연결됩니다."
            },
            {
                id: 63, type: 'fill-in', text: "63. RNA는 한 가닥의 폴리뉴클레오타이드로 이루어진 (   ) 구조로 유전 정보를 (   )하고 (   ) 합성에 관여한다.",
                answer: "단일가닥;전달;단백질", options: ["이중나선;저장;DNA", "단일가닥;전달;단백질", "원형;복제;지질", "선형;분해;탄수화물"],
                explanation: "RNA는 일반적으로 한 가닥의 폴리뉴클레오타이드로 구성된 단일 가닥 구조를 가집니다. DNA의 유전 정보를 리보솜으로 전달하여 단백질 합성에 직접 관여하는 등 다양한 기능을 수행합니다."
            },
            {
                id: 64, type: 'fill-in', text: "64. DNA는 두 가닥의 (   )로 이루어진 (   )구조로 유전 정보를 (   )한다.",
                answer: "폴리뉴클레오타이드;이중나선;저장", options: ["아미노산;알파나선;운반", "단당류;고리;생성", "폴리뉴클레오타이드;이중나선;저장", "지방산;미셀;분해"],
                explanation: "DNA는 두 가닥의 폴리뉴클레오타이드가 서로 마주보며 염기 간의 수소 결합을 통해 꼬여 있는 이중 나선 구조를 이룹니다. DNA는 생명체의 유전 정보를 저장하는 역할을 합니다."
            },
            {
                id: 65, type: 'fill-in', text: "65. (   )의 순서에 따라 유전 정보가 결정 된다.",
                answer: "염기", options: ["당", "인산", "염기", "아미노산"],
                explanation: "DNA나 RNA 가닥에서 뉴클레오타이드에 포함된 4종류의 염기(A, G, C, T 또는 U)가 어떤 순서로 배열되어 있느냐에 따라 유전 정보가 암호화됩니다. 이 염기 서열이 단백질을 구성하는 아미노산의 종류와 순서를 결정합니다."
            },
            {
                id: 66, type: 'ox', text: "66. RNA 안의 염기 A와 염기 U의 개수는 항상 동일하다.",
                answer: "X", options: ["O", "X"],
                explanation: "RNA는 단일 가닥 구조이므로, DNA의 이중 나선에서처럼 상보적인 염기쌍(A-T, G-C)의 수가 항상 같아야 하는 샤가프의 법칙이 적용되지 않습니다. 따라서 RNA에서 A와 U의 개수가 항상 같지는 않습니다."
            },
            {
                id: 67, type: 'ox', text: "67. RNA 안의 염기 C와 염기 G의 개수는 항상 동일하다.",
                answer: "X", options: ["X", "O"],
                explanation: "RNA는 단일 가닥이므로, DNA와 달리 C와 G의 개수가 항상 같을 필요는 없습니다. (단, RNA 가닥 내에서 부분적으로 이중 가닥 구조를 형성하는 경우에는 그 부분에서 상보적 결합이 나타날 수 있습니다.)"
            },
            {
                id: 68, type: 'ox', text: "68. DNA 안의 염기 A와 염기 T의 개수는 항상 동일하다.",
                answer: "O", options: ["O", "X"],
                explanation: "DNA는 이중 나선 구조에서 아데닌(A)은 항상 타이민(T)과 2개의 수소 결합을, 구아닌(G)은 항상 사이토신(C)과 3개의 수소 결합을 형성하며 상보적으로 결합합니다 (샤가프의 법칙). 따라서 한 DNA 분자 내에서 A의 양은 T의 양과 같고, G의 양은 C의 양과 같습니다."
            },
            {
                id: 69, type: 'ox', text: "69. DNA 안의 염기 A와 염기 U의 개수는 항상 동일하다.",
                answer: "X", options: ["X", "O"],
                explanation: "DNA에는 유라실(U) 염기가 존재하지 않습니다. 유라실은 RNA에만 존재하며 DNA의 타이민(T)에 해당하는 염기입니다. DNA에서 A는 T와 짝을 이룹니다."
            },
            {
                id: 70, type: 'ox', text: "70. DNA 안의 염기 C와 염기 G의 개수는 항상 동일하다.",
                answer: "O", options: ["O", "X"],
                explanation: "DNA의 이중 나선 구조에서 사이토신(C)은 항상 구아닌(G)과 상보적으로 3개의 수소 결합을 형성하므로, DNA 분자 내에서 C의 양은 G의 양과 항상 같습니다."
            },
            {
                id: 71, type: 'ox', text: "71. 생물의 염색체 안에는 DNA가 들어 있다.",
                answer: "O", options: ["X", "O"],
                explanation: "염색체는 세포 분열 시 핵 속에 나타나는 막대 모양의 구조물로, 유전 물질인 DNA가 히스톤 단백질 등과 함께 응축되어 있는 형태입니다."
            },
            {
                id: 72, type: 'ox', text: "72. 생물의 핵 안에는 DNA가 들어 있다.",
                answer: "O", options: ["O", "X"],
                explanation: "진핵생물의 경우, 유전 정보를 담고 있는 DNA는 주로 세포의 핵 안에 염색체 형태로 존재합니다. (미토콘드리아나 엽록체에도 자체 DNA가 소량 존재합니다.)"
            },
            {
                id: 73, type: 'fill-in', text: "73. [복자] 단백질과 탄수화물, 핵산 중 에너지로 쓸 수 없는 것은 (   )이다.",
                answer: "핵산", options: ["단백질", "탄수화물", "핵산", "모두 에너지원"],
                explanation: "탄수화물과 지방이 주된 에너지원이며, 단백질도 필요시 에너지원으로 사용될 수 있습니다. 하지만 핵산(DNA, RNA)은 유전 정보의 저장 및 전달이 주된 기능이며, 일반적으로 에너지원으로 직접 사용되지는 않습니다."
            },
            {
                id: 74, type: 'ox', text: "74. [복자] 펩타이드 결합은 탈수축합 반응이다.", // PDF에는 74번이 없고 75번만 있음. 74번은 PDF에 없는 문제로 가정하고 추가.
                answer: "O", options: ["X", "O"],
                explanation: "아미노산들이 결합하여 펩타이드 결합을 형성할 때 물 분자 하나가 빠져나오므로, 펩타이드 결합은 탈수 축합 반응의 일종입니다."
            },
            {
                id: 75, type: 'fill-in', text: "75. [복자] DNA 이중나선에서 염기끼리 서로 상보적 결합을 할 때 (   ) 결합을 하며 이를 (   ) 결합이라 한다.",
                answer: "수소;수소", options: ["공유;공유", "이온;이온", "수소;수소", "펩타이드;펩타이드"],
                explanation: "DNA 이중 나선 구조에서 마주 보는 두 가닥의 염기들은 상보적으로 결합합니다. 아데닌(A)과 타이민(T) 사이에는 2개의 수소 결합이, 구아닌(G)과 사이토신(C) 사이에는 3개의 수소 결합이 형성됩니다."
            }
        ];

        // 명언 목록
        const motivationalQuotes = [
            "오늘의 노력이 내일의 너를 만든다.", "포기하지 않는 한, 실패는 없다.", "가장 큰 위험은 아무 위험도 감수하지 않는 것이다.",
            "배움은 의무도, 생존도 아니다. 그것은 우리의 가장 큰 특권이다.", "성공은 최종 목적지가 아니며, 실패는 치명적이지 않다. 중요한 것은 계속 나아가는 용기다.",
            "작은 성공들이 모여 큰 성공을 이룬다.", "어제보다 나은 오늘, 오늘보다 나은 내일을 만들자.",
            "가장 큰 영광은 한 번도 실패하지 않음이 아니라 실패할 때마다 다시 일어서는 데에 있다.", "천리길도 한 걸음부터.", "노력은 결코 배신하지 않는다."
        ];

        const quizElement = document.getElementById('quiz');
        const paginationControlsElement = document.getElementById('pagination-controls');
        const submitPageButton = document.getElementById('submit-page-btn');
        const scoreSectionElement = document.getElementById('score-section');
        const currentPageScoreTextElement = document.getElementById('current-page-score-text');
        const totalScoreTextElement = document.getElementById('total-score-text');
        const pageInfoElement = document.getElementById('page-info');
        const quizMainTitleDisplayElement = document.getElementById('quiz-main-title-in-score');
        const motivationalQuoteElement = document.getElementById('motivational-quote'); 
        
        const welcomePopup = document.getElementById('welcome-popup');
        const popupPasswordInput = document.getElementById('popup-password');
        const popupConfirmButton = document.getElementById('popup-confirm');
        const popupErrorMessage = document.getElementById('popup-error');

        const correctPassword = "0407"; 

        const questionsPerPage = 10; 
        let currentPage = 0;
        let pageScores = []; 
        let pageAttempted = []; 

        function initializeQuizData() {
            questions.forEach(q => {
                q.userAnswer = null;
                q.isCorrect = null;
                q.attemptedThisSession = false; 
                if (q.answer && q.answer.includes(';')) {
                    q.answersArray = q.answer.split(';');
                } else if (q.answer) {
                    q.answersArray = [q.answer];
                } else {
                    q.answersArray = [];
                }
            });
            const numPages = Math.ceil(questions.length / questionsPerPage);
            pageAttempted = new Array(numPages).fill(false);
            pageScores = new Array(numPages).fill(0);
        }


        function renderQuestionsForPage(page) {
            quizElement.innerHTML = ''; 
            currentPage = page;

            const start = page * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            pageInfoElement.textContent = `총 ${questions.length}문제 중 ${start + 1} - ${end}번 문제`;


            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = document.createElement('div');
                questionCard.classList.add('question-card');
                questionCard.id = `question-${q.id}`;

                const questionText = document.createElement('p');
                questionText.classList.add('question-text');
                let questionHTML = q.text;
                if (q.answersArray && q.answersArray.length > 1) { 
                    let blankCount = 0;
                    questionHTML = q.text.replace(/(\(\s*(?:[^)]*)\s*\))/g, (match) => {
                        blankCount++;
                        return `<span class="blank-emphasis">( ${"&nbsp;&nbsp;&nbsp;".repeat(q.answersArray[blankCount-1] ? q.answersArray[blankCount-1].length/2 +1 : 3)} )</span>`;
                    });
                } else { 
                     questionHTML = q.text.replace(/(\(\s*(?:[^)]*)\s*\))/g, '<span class="blank-emphasis">( &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</span>');
                }
                questionText.innerHTML = questionHTML; 
                questionCard.appendChild(questionText);

                const optionsContainer = document.createElement('div');
                optionsContainer.classList.add('options');

                q.options.forEach(option => {
                    const optionId = `q${String(q.id).replace(/[^a-zA-Z0-9]/g, '')}-option-${option.replace(/[^a-zA-Z0-9ㄱ-ㅎㅏ-ㅣ가-힣$]/g, '')}`;
                    
                    const radioInput = document.createElement('input');
                    radioInput.type = 'radio';
                    radioInput.id = optionId;
                    radioInput.name = `question-${q.id}`; 
                    radioInput.value = option; 
                    radioInput.classList.add('option-input', 'hidden');
                    if (q.userAnswer === option) radioInput.checked = true; 
                    if (pageAttempted[currentPage]) radioInput.disabled = true;

                    const optionLabel = document.createElement('label');
                    optionLabel.htmlFor = optionId;
                    optionLabel.innerHTML = option.includes(';') ? option.split(';').join(', ') : option; 
                    optionLabel.classList.add('option-label');
                    if (pageAttempted[currentPage]) optionLabel.classList.add('opacity-70', 'cursor-not-allowed');

                    optionsContainer.appendChild(radioInput);
                    optionsContainer.appendChild(optionLabel);
                });
                questionCard.appendChild(optionsContainer);

                const feedbackElement = document.createElement('div');
                feedbackElement.classList.add('feedback');
                feedbackElement.style.display = 'none'; 
                questionCard.appendChild(feedbackElement);
                
                if (pageAttempted[currentPage] && q.attemptedThisSession) {
                    showFeedbackForQuestion(q, questionCard);
                }
                quizElement.appendChild(questionCard);
            });
            
            const numPages = Math.ceil(questions.length / questionsPerPage);
            if (numPages > 1) {
                paginationControlsElement.style.display = 'flex';
                renderPaginationControls();
            } else {
                paginationControlsElement.style.display = 'none';
            }


            submitPageButton.disabled = pageAttempted[currentPage];
            if (pageAttempted[currentPage]) {
                submitPageButton.textContent = '채점 완료';
                scoreSectionElement.style.display = 'block'; 
                updateScoreDisplay(); 
                showMotivationalQuote(); 
            } else {
                submitPageButton.textContent = '이번 페이지 채점하기'; 
                motivationalQuoteElement.style.display = 'none'; 
                if (questionsOnPage.length > 0) { 
                     scoreSectionElement.style.display = 'none';
                } else { 
                     scoreSectionElement.style.display = 'block';
                     currentPageScoreTextElement.textContent = '이번 페이지에 문제가 없습니다.';
                     totalScoreTextElement.textContent = '';
                }
            }
        }
        
        function showFeedbackForQuestion(question, questionCard) {
            const feedbackElement = questionCard.querySelector('.feedback');
            if (!feedbackElement) return;

            feedbackElement.innerHTML = ''; 
            const correctAnswerText = question.answersArray.join(', ');

            if (question.isCorrect) {
                feedbackElement.innerHTML = '<strong class="font-semibold">정답입니다!</strong> 🎉';
                feedbackElement.className = 'feedback correct';
            } else {
                feedbackElement.innerHTML = `<strong class="font-semibold">오답입니다.</strong> 정답은 "<span class="font-bold text-red-700">${correctAnswerText}</span>"입니다.`;
                feedbackElement.className = 'feedback incorrect';
            }

            const explanationElement = document.createElement('p');
            explanationElement.classList.add('explanation');
            explanationElement.innerHTML = `<strong class="font-semibold">해설:</strong> ${question.explanation}`; 
            feedbackElement.appendChild(explanationElement);
            feedbackElement.style.display = 'block';
        }

        function renderPaginationControls() {
            paginationControlsElement.innerHTML = '';
            const numPages = Math.ceil(questions.length / questionsPerPage);

            const prevButton = document.createElement('button');
            prevButton.textContent = '이전';
            prevButton.disabled = currentPage === 0;
            prevButton.onclick = () => renderQuestionsForPage(currentPage - 1);
            paginationControlsElement.appendChild(prevButton);

            for (let i = 0; i < numPages; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i + 1;
                pageButton.classList.add('page-number');
                if (i === currentPage) {
                    pageButton.classList.add('current');
                }
                pageButton.onclick = () => renderQuestionsForPage(i);
                paginationControlsElement.appendChild(pageButton);
            }

            const nextButton = document.createElement('button');
            nextButton.textContent = '다음';
            nextButton.disabled = currentPage === numPages - 1;
            nextButton.onclick = () => renderQuestionsForPage(currentPage + 1);
            paginationControlsElement.appendChild(nextButton);
        }

        function showMotivationalQuote() {
            const randomIndex = Math.floor(Math.random() * motivationalQuotes.length);
            motivationalQuoteElement.textContent = motivationalQuotes[randomIndex];
            motivationalQuoteElement.style.display = 'block';
        }

        submitPageButton.addEventListener('click', () => {
            if (pageAttempted[currentPage]) return; 

            let scoreForThisPage = 0;
            
            const start = currentPage * questionsPerPage;
            const end = Math.min(start + questionsPerPage, questions.length);
            const questionsOnPage = questions.slice(start, end);

            questionsOnPage.forEach((q, indexOnPage) => {
                const questionCard = quizElement.children[indexOnPage]; 
                const selectedOptionInput = questionCard.querySelector(`input[name="question-${q.id}"]:checked`);
                
                q.attemptedThisSession = true;

                if (selectedOptionInput) {
                    q.userAnswer = selectedOptionInput.value; 
                    q.isCorrect = (q.userAnswer === q.answer); 
                                        
                    if (q.isCorrect) {
                        scoreForThisPage++; 
                    }
                    showFeedbackForQuestion(q, questionCard);

                    const radioInputs = questionCard.querySelectorAll('input[type="radio"]');
                    radioInputs.forEach(input => input.disabled = true);
                } else {
                    const feedbackElement = questionCard.querySelector('.feedback');
                    feedbackElement.textContent = '답을 선택하지 않았습니다.';
                    feedbackElement.className = 'feedback incorrect';
                    feedbackElement.style.display = 'block';
                    q.isCorrect = false; 
                }
            });
            
            pageScores[currentPage] = scoreForThisPage;
            pageAttempted[currentPage] = true;
            submitPageButton.disabled = true;
            submitPageButton.textContent = '채점 완료';
            
            scoreSectionElement.style.display = 'block';
            updateScoreDisplay();
            showMotivationalQuote(); 

            const quizContainerElement = document.querySelector('.quiz-container');
            if (quizContainerElement) {
                quizContainerElement.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        });

        function updateScoreDisplay() {
            const questionsOnThisPageCount = Math.min(questionsPerPage, questions.length - (currentPage * questionsPerPage)); 
            currentPageScoreTextElement.textContent = `이번 페이지 점수: ${pageScores[currentPage]} / ${questionsOnThisPageCount}`;
            
            let currentTotalScore = 0;
            let currentTotalAttemptedQuestions = 0;
            for(let i=0; i < pageAttempted.length; i++){
                if(pageAttempted[i]){
                    const start = i * questionsPerPage;
                    const end = Math.min(start + questionsPerPage, questions.length);
                    currentTotalAttemptedQuestions += (end-start);
                    currentTotalScore += pageScores[i];
                }
            }

            const quizTitleElement = document.querySelector('h1'); 
            let quizMainTitle = "현재 단원";
            if (quizTitleElement) {
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = quizTitleElement.innerHTML; 
                quizMainTitle = tempDiv.textContent || tempDiv.innerText || "";
                const titleParts = quizMainTitle.split('(');
                if (titleParts.length > 0) {
                    quizMainTitle = titleParts[0].trim();
                }
            }
            
            if (quizMainTitleDisplayElement) { 
                quizMainTitleDisplayElement.textContent = quizMainTitle;
            }

            if (currentTotalAttemptedQuestions > 0) {
                 totalScoreTextElement.style.display = 'block'; 
                 totalScoreTextElement.textContent = `총 누적 점수: ${currentTotalScore} / ${currentTotalAttemptedQuestions}`;
            } else {
                 totalScoreTextElement.style.display = 'none'; 
            }
        }
        
        // 팝업 기능
        window.onload = () => {
            if (welcomePopup) {
                // 각 퀴즈 페이지마다 고유한 sessionStorage 키 사용
                const popupSessionKey = 'appiaQuizPasswordEntered_matter_composition_1_75'; 
                const popupShownThisSession = sessionStorage.getItem(popupSessionKey); 
                if (!popupShownThisSession) { 
                    welcomePopup.classList.add('show');
                } else {
                    initializeQuizData();
                    renderQuestionsForPage(0);
                }
            } else { 
                initializeQuizData();
                renderQuestionsForPage(0);
            }
        };

        if (popupConfirmButton) {
            popupConfirmButton.addEventListener('click', () => {
                if (popupPasswordInput.value === correctPassword) {
                    if (welcomePopup) {
                        welcomePopup.classList.remove('show');
                    }
                    const popupSessionKey = 'appiaQuizPasswordEntered_matter_composition_1_75';
                    sessionStorage.setItem(popupSessionKey, 'true'); 
                    initializeQuizData(); 
                    renderQuestionsForPage(0);
                } else {
                    if (popupErrorMessage) {
                        popupErrorMessage.textContent = "비밀번호가 틀렸습니다. 다시 시도해주세요.";
                    }
                    popupPasswordInput.value = ''; 
                    popupPasswordInput.focus(); 
                }
            });
        }
        
        if (popupPasswordInput) {
            popupPasswordInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault(); 
                    popupConfirmButton.click();
                }
            });
        }

    </script>
</body>
</html>
